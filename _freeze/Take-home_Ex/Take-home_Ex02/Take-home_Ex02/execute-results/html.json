{
  "hash": "b45ec78b43a9ac4e4b31cb791de06709",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 2\"\nauthor: \"Brigitta Karen Tsai\"\ndate: \"March 3, 2025\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  message: false\n  freeze: true\n---\n\n\n# Be Tradewise or Otherwise\n\n# 1 Overview\n\n## 1.1 The Background\n\n## 1.2 The Data\n\nFor this analysis, the data will be taken from [SingStat](https://www.singstat.gov.sg/find-data/search-by-theme/trade-and-investment/merchandise-trade/latest-data), the following are the list of data used:\n\n1.  **Merchandise Trade by Region and Selected Markets**\n    1.  Imports\n    2.  Domestic Exports\n    3.  Re-Exports\n\n## 1.3 The Task\n\nThere are several tasks assigned for this paper:\n\n1.  Select 3 visualisations from [this page](https://www.singstat.gov.sg/modules/infographics/singapore-international-trade), comment the pros and cons and provide the sketches of the make-over\n2.  Create the makeover of the 3 data visualisation critic\n3.  Analyse the data with time-series analysis by complimenting the analysis using appropriate visualisation methods\n\n# 2 Getting Started\n\n## 2.1 Install and Load R Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, tsibble, feasts, fable, seasonal, lubridate,\n               data.table, dplyr)\n```\n:::\n\n\n## 2.2 Import Data\n\n::: panel-tabset\n### Imports\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimports <- read_csv(\"data/imports.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\nRows: 187 Columns: 266\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(266): ...1, ...2, ...3, ...4, ...5, ...6, ...7, ...8, ...9, ...10, ...1...\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -> `...1`\n• `` -> `...2`\n• `` -> `...3`\n• `` -> `...4`\n• `` -> `...5`\n• `` -> `...6`\n• `` -> `...7`\n• `` -> `...8`\n• `` -> `...9`\n• `` -> `...10`\n• `` -> `...11`\n• `` -> `...12`\n• `` -> `...13`\n• `` -> `...14`\n• `` -> `...15`\n• `` -> `...16`\n• `` -> `...17`\n• `` -> `...18`\n• `` -> `...19`\n• `` -> `...20`\n• `` -> `...21`\n• `` -> `...22`\n• `` -> `...23`\n• `` -> `...24`\n• `` -> `...25`\n• `` -> `...26`\n• `` -> `...27`\n• `` -> `...28`\n• `` -> `...29`\n• `` -> `...30`\n• `` -> `...31`\n• `` -> `...32`\n• `` -> `...33`\n• `` -> `...34`\n• `` -> `...35`\n• `` -> `...36`\n• `` -> `...37`\n• `` -> `...38`\n• `` -> `...39`\n• `` -> `...40`\n• `` -> `...41`\n• `` -> `...42`\n• `` -> `...43`\n• `` -> `...44`\n• `` -> `...45`\n• `` -> `...46`\n• `` -> `...47`\n• `` -> `...48`\n• `` -> `...49`\n• `` -> `...50`\n• `` -> `...51`\n• `` -> `...52`\n• `` -> `...53`\n• `` -> `...54`\n• `` -> `...55`\n• `` -> `...56`\n• `` -> `...57`\n• `` -> `...58`\n• `` -> `...59`\n• `` -> `...60`\n• `` -> `...61`\n• `` -> `...62`\n• `` -> `...63`\n• `` -> `...64`\n• `` -> `...65`\n• `` -> `...66`\n• `` -> `...67`\n• `` -> `...68`\n• `` -> `...69`\n• `` -> `...70`\n• `` -> `...71`\n• `` -> `...72`\n• `` -> `...73`\n• `` -> `...74`\n• `` -> `...75`\n• `` -> `...76`\n• `` -> `...77`\n• `` -> `...78`\n• `` -> `...79`\n• `` -> `...80`\n• `` -> `...81`\n• `` -> `...82`\n• `` -> `...83`\n• `` -> `...84`\n• `` -> `...85`\n• `` -> `...86`\n• `` -> `...87`\n• `` -> `...88`\n• `` -> `...89`\n• `` -> `...90`\n• `` -> `...91`\n• `` -> `...92`\n• `` -> `...93`\n• `` -> `...94`\n• `` -> `...95`\n• `` -> `...96`\n• `` -> `...97`\n• `` -> `...98`\n• `` -> `...99`\n• `` -> `...100`\n• `` -> `...101`\n• `` -> `...102`\n• `` -> `...103`\n• `` -> `...104`\n• `` -> `...105`\n• `` -> `...106`\n• `` -> `...107`\n• `` -> `...108`\n• `` -> `...109`\n• `` -> `...110`\n• `` -> `...111`\n• `` -> `...112`\n• `` -> `...113`\n• `` -> `...114`\n• `` -> `...115`\n• `` -> `...116`\n• `` -> `...117`\n• `` -> `...118`\n• `` -> `...119`\n• `` -> `...120`\n• `` -> `...121`\n• `` -> `...122`\n• `` -> `...123`\n• `` -> `...124`\n• `` -> `...125`\n• `` -> `...126`\n• `` -> `...127`\n• `` -> `...128`\n• `` -> `...129`\n• `` -> `...130`\n• `` -> `...131`\n• `` -> `...132`\n• `` -> `...133`\n• `` -> `...134`\n• `` -> `...135`\n• `` -> `...136`\n• `` -> `...137`\n• `` -> `...138`\n• `` -> `...139`\n• `` -> `...140`\n• `` -> `...141`\n• `` -> `...142`\n• `` -> `...143`\n• `` -> `...144`\n• `` -> `...145`\n• `` -> `...146`\n• `` -> `...147`\n• `` -> `...148`\n• `` -> `...149`\n• `` -> `...150`\n• `` -> `...151`\n• `` -> `...152`\n• `` -> `...153`\n• `` -> `...154`\n• `` -> `...155`\n• `` -> `...156`\n• `` -> `...157`\n• `` -> `...158`\n• `` -> `...159`\n• `` -> `...160`\n• `` -> `...161`\n• `` -> `...162`\n• `` -> `...163`\n• `` -> `...164`\n• `` -> `...165`\n• `` -> `...166`\n• `` -> `...167`\n• `` -> `...168`\n• `` -> `...169`\n• `` -> `...170`\n• `` -> `...171`\n• `` -> `...172`\n• `` -> `...173`\n• `` -> `...174`\n• `` -> `...175`\n• `` -> `...176`\n• `` -> `...177`\n• `` -> `...178`\n• `` -> `...179`\n• `` -> `...180`\n• `` -> `...181`\n• `` -> `...182`\n• `` -> `...183`\n• `` -> `...184`\n• `` -> `...185`\n• `` -> `...186`\n• `` -> `...187`\n• `` -> `...188`\n• `` -> `...189`\n• `` -> `...190`\n• `` -> `...191`\n• `` -> `...192`\n• `` -> `...193`\n• `` -> `...194`\n• `` -> `...195`\n• `` -> `...196`\n• `` -> `...197`\n• `` -> `...198`\n• `` -> `...199`\n• `` -> `...200`\n• `` -> `...201`\n• `` -> `...202`\n• `` -> `...203`\n• `` -> `...204`\n• `` -> `...205`\n• `` -> `...206`\n• `` -> `...207`\n• `` -> `...208`\n• `` -> `...209`\n• `` -> `...210`\n• `` -> `...211`\n• `` -> `...212`\n• `` -> `...213`\n• `` -> `...214`\n• `` -> `...215`\n• `` -> `...216`\n• `` -> `...217`\n• `` -> `...218`\n• `` -> `...219`\n• `` -> `...220`\n• `` -> `...221`\n• `` -> `...222`\n• `` -> `...223`\n• `` -> `...224`\n• `` -> `...225`\n• `` -> `...226`\n• `` -> `...227`\n• `` -> `...228`\n• `` -> `...229`\n• `` -> `...230`\n• `` -> `...231`\n• `` -> `...232`\n• `` -> `...233`\n• `` -> `...234`\n• `` -> `...235`\n• `` -> `...236`\n• `` -> `...237`\n• `` -> `...238`\n• `` -> `...239`\n• `` -> `...240`\n• `` -> `...241`\n• `` -> `...242`\n• `` -> `...243`\n• `` -> `...244`\n• `` -> `...245`\n• `` -> `...246`\n• `` -> `...247`\n• `` -> `...248`\n• `` -> `...249`\n• `` -> `...250`\n• `` -> `...251`\n• `` -> `...252`\n• `` -> `...253`\n• `` -> `...254`\n• `` -> `...255`\n• `` -> `...256`\n• `` -> `...257`\n• `` -> `...258`\n• `` -> `...259`\n• `` -> `...260`\n• `` -> `...261`\n• `` -> `...262`\n• `` -> `...263`\n• `` -> `...264`\n• `` -> `...265`\n• `` -> `...266`\n```\n\n\n:::\n:::\n\n\n### Domestic Exports\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndom_exports <- read_csv(\"data/dom_exports.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\nRows: 191 Columns: 266\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(266): ...1, ...2, ...3, ...4, ...5, ...6, ...7, ...8, ...9, ...10, ...1...\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -> `...1`\n• `` -> `...2`\n• `` -> `...3`\n• `` -> `...4`\n• `` -> `...5`\n• `` -> `...6`\n• `` -> `...7`\n• `` -> `...8`\n• `` -> `...9`\n• `` -> `...10`\n• `` -> `...11`\n• `` -> `...12`\n• `` -> `...13`\n• `` -> `...14`\n• `` -> `...15`\n• `` -> `...16`\n• `` -> `...17`\n• `` -> `...18`\n• `` -> `...19`\n• `` -> `...20`\n• `` -> `...21`\n• `` -> `...22`\n• `` -> `...23`\n• `` -> `...24`\n• `` -> `...25`\n• `` -> `...26`\n• `` -> `...27`\n• `` -> `...28`\n• `` -> `...29`\n• `` -> `...30`\n• `` -> `...31`\n• `` -> `...32`\n• `` -> `...33`\n• `` -> `...34`\n• `` -> `...35`\n• `` -> `...36`\n• `` -> `...37`\n• `` -> `...38`\n• `` -> `...39`\n• `` -> `...40`\n• `` -> `...41`\n• `` -> `...42`\n• `` -> `...43`\n• `` -> `...44`\n• `` -> `...45`\n• `` -> `...46`\n• `` -> `...47`\n• `` -> `...48`\n• `` -> `...49`\n• `` -> `...50`\n• `` -> `...51`\n• `` -> `...52`\n• `` -> `...53`\n• `` -> `...54`\n• `` -> `...55`\n• `` -> `...56`\n• `` -> `...57`\n• `` -> `...58`\n• `` -> `...59`\n• `` -> `...60`\n• `` -> `...61`\n• `` -> `...62`\n• `` -> `...63`\n• `` -> `...64`\n• `` -> `...65`\n• `` -> `...66`\n• `` -> `...67`\n• `` -> `...68`\n• `` -> `...69`\n• `` -> `...70`\n• `` -> `...71`\n• `` -> `...72`\n• `` -> `...73`\n• `` -> `...74`\n• `` -> `...75`\n• `` -> `...76`\n• `` -> `...77`\n• `` -> `...78`\n• `` -> `...79`\n• `` -> `...80`\n• `` -> `...81`\n• `` -> `...82`\n• `` -> `...83`\n• `` -> `...84`\n• `` -> `...85`\n• `` -> `...86`\n• `` -> `...87`\n• `` -> `...88`\n• `` -> `...89`\n• `` -> `...90`\n• `` -> `...91`\n• `` -> `...92`\n• `` -> `...93`\n• `` -> `...94`\n• `` -> `...95`\n• `` -> `...96`\n• `` -> `...97`\n• `` -> `...98`\n• `` -> `...99`\n• `` -> `...100`\n• `` -> `...101`\n• `` -> `...102`\n• `` -> `...103`\n• `` -> `...104`\n• `` -> `...105`\n• `` -> `...106`\n• `` -> `...107`\n• `` -> `...108`\n• `` -> `...109`\n• `` -> `...110`\n• `` -> `...111`\n• `` -> `...112`\n• `` -> `...113`\n• `` -> `...114`\n• `` -> `...115`\n• `` -> `...116`\n• `` -> `...117`\n• `` -> `...118`\n• `` -> `...119`\n• `` -> `...120`\n• `` -> `...121`\n• `` -> `...122`\n• `` -> `...123`\n• `` -> `...124`\n• `` -> `...125`\n• `` -> `...126`\n• `` -> `...127`\n• `` -> `...128`\n• `` -> `...129`\n• `` -> `...130`\n• `` -> `...131`\n• `` -> `...132`\n• `` -> `...133`\n• `` -> `...134`\n• `` -> `...135`\n• `` -> `...136`\n• `` -> `...137`\n• `` -> `...138`\n• `` -> `...139`\n• `` -> `...140`\n• `` -> `...141`\n• `` -> `...142`\n• `` -> `...143`\n• `` -> `...144`\n• `` -> `...145`\n• `` -> `...146`\n• `` -> `...147`\n• `` -> `...148`\n• `` -> `...149`\n• `` -> `...150`\n• `` -> `...151`\n• `` -> `...152`\n• `` -> `...153`\n• `` -> `...154`\n• `` -> `...155`\n• `` -> `...156`\n• `` -> `...157`\n• `` -> `...158`\n• `` -> `...159`\n• `` -> `...160`\n• `` -> `...161`\n• `` -> `...162`\n• `` -> `...163`\n• `` -> `...164`\n• `` -> `...165`\n• `` -> `...166`\n• `` -> `...167`\n• `` -> `...168`\n• `` -> `...169`\n• `` -> `...170`\n• `` -> `...171`\n• `` -> `...172`\n• `` -> `...173`\n• `` -> `...174`\n• `` -> `...175`\n• `` -> `...176`\n• `` -> `...177`\n• `` -> `...178`\n• `` -> `...179`\n• `` -> `...180`\n• `` -> `...181`\n• `` -> `...182`\n• `` -> `...183`\n• `` -> `...184`\n• `` -> `...185`\n• `` -> `...186`\n• `` -> `...187`\n• `` -> `...188`\n• `` -> `...189`\n• `` -> `...190`\n• `` -> `...191`\n• `` -> `...192`\n• `` -> `...193`\n• `` -> `...194`\n• `` -> `...195`\n• `` -> `...196`\n• `` -> `...197`\n• `` -> `...198`\n• `` -> `...199`\n• `` -> `...200`\n• `` -> `...201`\n• `` -> `...202`\n• `` -> `...203`\n• `` -> `...204`\n• `` -> `...205`\n• `` -> `...206`\n• `` -> `...207`\n• `` -> `...208`\n• `` -> `...209`\n• `` -> `...210`\n• `` -> `...211`\n• `` -> `...212`\n• `` -> `...213`\n• `` -> `...214`\n• `` -> `...215`\n• `` -> `...216`\n• `` -> `...217`\n• `` -> `...218`\n• `` -> `...219`\n• `` -> `...220`\n• `` -> `...221`\n• `` -> `...222`\n• `` -> `...223`\n• `` -> `...224`\n• `` -> `...225`\n• `` -> `...226`\n• `` -> `...227`\n• `` -> `...228`\n• `` -> `...229`\n• `` -> `...230`\n• `` -> `...231`\n• `` -> `...232`\n• `` -> `...233`\n• `` -> `...234`\n• `` -> `...235`\n• `` -> `...236`\n• `` -> `...237`\n• `` -> `...238`\n• `` -> `...239`\n• `` -> `...240`\n• `` -> `...241`\n• `` -> `...242`\n• `` -> `...243`\n• `` -> `...244`\n• `` -> `...245`\n• `` -> `...246`\n• `` -> `...247`\n• `` -> `...248`\n• `` -> `...249`\n• `` -> `...250`\n• `` -> `...251`\n• `` -> `...252`\n• `` -> `...253`\n• `` -> `...254`\n• `` -> `...255`\n• `` -> `...256`\n• `` -> `...257`\n• `` -> `...258`\n• `` -> `...259`\n• `` -> `...260`\n• `` -> `...261`\n• `` -> `...262`\n• `` -> `...263`\n• `` -> `...264`\n• `` -> `...265`\n• `` -> `...266`\n```\n\n\n:::\n:::\n\n\n### Re-Exports\n\n\n::: {.cell}\n\n```{.r .cell-code}\nre_exports <- read_csv(\"data/re_exports.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\nRows: 191 Columns: 266\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(266): ...1, ...2, ...3, ...4, ...5, ...6, ...7, ...8, ...9, ...10, ...1...\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -> `...1`\n• `` -> `...2`\n• `` -> `...3`\n• `` -> `...4`\n• `` -> `...5`\n• `` -> `...6`\n• `` -> `...7`\n• `` -> `...8`\n• `` -> `...9`\n• `` -> `...10`\n• `` -> `...11`\n• `` -> `...12`\n• `` -> `...13`\n• `` -> `...14`\n• `` -> `...15`\n• `` -> `...16`\n• `` -> `...17`\n• `` -> `...18`\n• `` -> `...19`\n• `` -> `...20`\n• `` -> `...21`\n• `` -> `...22`\n• `` -> `...23`\n• `` -> `...24`\n• `` -> `...25`\n• `` -> `...26`\n• `` -> `...27`\n• `` -> `...28`\n• `` -> `...29`\n• `` -> `...30`\n• `` -> `...31`\n• `` -> `...32`\n• `` -> `...33`\n• `` -> `...34`\n• `` -> `...35`\n• `` -> `...36`\n• `` -> `...37`\n• `` -> `...38`\n• `` -> `...39`\n• `` -> `...40`\n• `` -> `...41`\n• `` -> `...42`\n• `` -> `...43`\n• `` -> `...44`\n• `` -> `...45`\n• `` -> `...46`\n• `` -> `...47`\n• `` -> `...48`\n• `` -> `...49`\n• `` -> `...50`\n• `` -> `...51`\n• `` -> `...52`\n• `` -> `...53`\n• `` -> `...54`\n• `` -> `...55`\n• `` -> `...56`\n• `` -> `...57`\n• `` -> `...58`\n• `` -> `...59`\n• `` -> `...60`\n• `` -> `...61`\n• `` -> `...62`\n• `` -> `...63`\n• `` -> `...64`\n• `` -> `...65`\n• `` -> `...66`\n• `` -> `...67`\n• `` -> `...68`\n• `` -> `...69`\n• `` -> `...70`\n• `` -> `...71`\n• `` -> `...72`\n• `` -> `...73`\n• `` -> `...74`\n• `` -> `...75`\n• `` -> `...76`\n• `` -> `...77`\n• `` -> `...78`\n• `` -> `...79`\n• `` -> `...80`\n• `` -> `...81`\n• `` -> `...82`\n• `` -> `...83`\n• `` -> `...84`\n• `` -> `...85`\n• `` -> `...86`\n• `` -> `...87`\n• `` -> `...88`\n• `` -> `...89`\n• `` -> `...90`\n• `` -> `...91`\n• `` -> `...92`\n• `` -> `...93`\n• `` -> `...94`\n• `` -> `...95`\n• `` -> `...96`\n• `` -> `...97`\n• `` -> `...98`\n• `` -> `...99`\n• `` -> `...100`\n• `` -> `...101`\n• `` -> `...102`\n• `` -> `...103`\n• `` -> `...104`\n• `` -> `...105`\n• `` -> `...106`\n• `` -> `...107`\n• `` -> `...108`\n• `` -> `...109`\n• `` -> `...110`\n• `` -> `...111`\n• `` -> `...112`\n• `` -> `...113`\n• `` -> `...114`\n• `` -> `...115`\n• `` -> `...116`\n• `` -> `...117`\n• `` -> `...118`\n• `` -> `...119`\n• `` -> `...120`\n• `` -> `...121`\n• `` -> `...122`\n• `` -> `...123`\n• `` -> `...124`\n• `` -> `...125`\n• `` -> `...126`\n• `` -> `...127`\n• `` -> `...128`\n• `` -> `...129`\n• `` -> `...130`\n• `` -> `...131`\n• `` -> `...132`\n• `` -> `...133`\n• `` -> `...134`\n• `` -> `...135`\n• `` -> `...136`\n• `` -> `...137`\n• `` -> `...138`\n• `` -> `...139`\n• `` -> `...140`\n• `` -> `...141`\n• `` -> `...142`\n• `` -> `...143`\n• `` -> `...144`\n• `` -> `...145`\n• `` -> `...146`\n• `` -> `...147`\n• `` -> `...148`\n• `` -> `...149`\n• `` -> `...150`\n• `` -> `...151`\n• `` -> `...152`\n• `` -> `...153`\n• `` -> `...154`\n• `` -> `...155`\n• `` -> `...156`\n• `` -> `...157`\n• `` -> `...158`\n• `` -> `...159`\n• `` -> `...160`\n• `` -> `...161`\n• `` -> `...162`\n• `` -> `...163`\n• `` -> `...164`\n• `` -> `...165`\n• `` -> `...166`\n• `` -> `...167`\n• `` -> `...168`\n• `` -> `...169`\n• `` -> `...170`\n• `` -> `...171`\n• `` -> `...172`\n• `` -> `...173`\n• `` -> `...174`\n• `` -> `...175`\n• `` -> `...176`\n• `` -> `...177`\n• `` -> `...178`\n• `` -> `...179`\n• `` -> `...180`\n• `` -> `...181`\n• `` -> `...182`\n• `` -> `...183`\n• `` -> `...184`\n• `` -> `...185`\n• `` -> `...186`\n• `` -> `...187`\n• `` -> `...188`\n• `` -> `...189`\n• `` -> `...190`\n• `` -> `...191`\n• `` -> `...192`\n• `` -> `...193`\n• `` -> `...194`\n• `` -> `...195`\n• `` -> `...196`\n• `` -> `...197`\n• `` -> `...198`\n• `` -> `...199`\n• `` -> `...200`\n• `` -> `...201`\n• `` -> `...202`\n• `` -> `...203`\n• `` -> `...204`\n• `` -> `...205`\n• `` -> `...206`\n• `` -> `...207`\n• `` -> `...208`\n• `` -> `...209`\n• `` -> `...210`\n• `` -> `...211`\n• `` -> `...212`\n• `` -> `...213`\n• `` -> `...214`\n• `` -> `...215`\n• `` -> `...216`\n• `` -> `...217`\n• `` -> `...218`\n• `` -> `...219`\n• `` -> `...220`\n• `` -> `...221`\n• `` -> `...222`\n• `` -> `...223`\n• `` -> `...224`\n• `` -> `...225`\n• `` -> `...226`\n• `` -> `...227`\n• `` -> `...228`\n• `` -> `...229`\n• `` -> `...230`\n• `` -> `...231`\n• `` -> `...232`\n• `` -> `...233`\n• `` -> `...234`\n• `` -> `...235`\n• `` -> `...236`\n• `` -> `...237`\n• `` -> `...238`\n• `` -> `...239`\n• `` -> `...240`\n• `` -> `...241`\n• `` -> `...242`\n• `` -> `...243`\n• `` -> `...244`\n• `` -> `...245`\n• `` -> `...246`\n• `` -> `...247`\n• `` -> `...248`\n• `` -> `...249`\n• `` -> `...250`\n• `` -> `...251`\n• `` -> `...252`\n• `` -> `...253`\n• `` -> `...254`\n• `` -> `...255`\n• `` -> `...256`\n• `` -> `...257`\n• `` -> `...258`\n• `` -> `...259`\n• `` -> `...260`\n• `` -> `...261`\n• `` -> `...262`\n• `` -> `...263`\n• `` -> `...264`\n• `` -> `...265`\n• `` -> `...266`\n```\n\n\n:::\n:::\n\n:::\n\n## 2.3 Data Wrangling\n\n### 2.3.1 Processing Imports Data\n\nLet us have a quick glance of the dataframe using the code below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(imports)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 187 × 266\n   ...1  ...2  ...3  ...4  ...5  ...6  ...7  ...8  ...9  ...10 ...11 ...12 ...13\n   <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr>\n 1 Them… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 2 Subj… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 3 Topi… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 4 Tabl… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 5 <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 6 Data… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 7 Sour… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 8 <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 9 <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n10 Data… 2025… 2024… 2024… 2024… 2024… 2024… 2024… 2024… 2024… 2024… 2024… 2024…\n# ℹ 177 more rows\n# ℹ 253 more variables: ...14 <chr>, ...15 <chr>, ...16 <chr>, ...17 <chr>,\n#   ...18 <chr>, ...19 <chr>, ...20 <chr>, ...21 <chr>, ...22 <chr>,\n#   ...23 <chr>, ...24 <chr>, ...25 <chr>, ...26 <chr>, ...27 <chr>,\n#   ...28 <chr>, ...29 <chr>, ...30 <chr>, ...31 <chr>, ...32 <chr>,\n#   ...33 <chr>, ...34 <chr>, ...35 <chr>, ...36 <chr>, ...37 <chr>,\n#   ...38 <chr>, ...39 <chr>, ...40 <chr>, ...41 <chr>, ...42 <chr>, …\n```\n\n\n:::\n:::\n\n\nFor more enhanced analysis, let us split the dataframe into 2, by continent and by country\n\n::: panel-tabset\n### Country Level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_country <- imports[-c(1:9, 11, 12, 43, 85, 121, 136, 171:187), ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(imports_country) <- imports_country[1, ]\nimports_country <- imports_country[-1, ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_country <- imports_country %>% \n  pivot_longer(cols = -1, names_to = \"Date\", values_to = \"Value\") %>% \n  pivot_wider(names_from = colnames(imports_country)[1], values_from = \"Value\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_country$`Date` <- ym(\n  imports_country$`Date`\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_country <- imports_country %>%\n  mutate(\n    across(-Date, as.numeric)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_country <- imports_country %>% \n  mutate(Year = year(Date))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_country <- imports_country %>% \n  select(Year, everything(), -Date)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_country <- imports_country %>% \n  group_by(Year) %>%\n  summarise(across(where(is.numeric), sum, na.rm = TRUE))\n```\n:::\n\n\n### Continent Level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_continent <- imports[c(10, 12, 43, 85, 121, 136), ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(imports_continent) <- imports_continent[1, ]\nimports_continent <- imports_continent[-1, ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_continent <- imports_continent %>% \n  pivot_longer(cols = -1, names_to = \"Date\", values_to = \"Value\") %>% \n  pivot_wider(names_from = colnames(imports_continent)[1], values_from = \"Value\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_continent$`Date` <- ym(\n  imports_continent$`Date`\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_continent <- imports_continent %>%\n  mutate(\n    across(-Date, as.numeric)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_continent <- imports_continent %>% \n  mutate(Year = year(Date))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_continent <- imports_continent %>% \n  select(Year, everything(), -Date)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimports_continent <- imports_continent %>% \n  group_by(Year) %>%\n  summarise(across(where(is.numeric), sum, na.rm = TRUE))\n```\n:::\n\n:::\n\n### 2.3.2 Processing Domestic Exports Data\n\nLet us apply the same steps to both domestic exports and re-exports dataframe\n\n::: panel-tabset\n### Country Level\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_country <- dom_exports[-c(1:9, 11, 12, 43, 85, 121, 136, 171:191), ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(domexp_country) <- domexp_country[1, ]\ndomexp_country <- domexp_country[-1, ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_country <- domexp_country %>% \n  pivot_longer(cols = -1, names_to = \"Date\", values_to = \"Value\") %>% \n  pivot_wider(names_from = colnames(domexp_country)[1], values_from = \"Value\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_country$`Date` <- ym(\n  domexp_country$`Date`\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_country <- domexp_country %>%\n  mutate(\n    across(-Date, as.numeric)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_country <- domexp_country %>% \n  mutate(Year = year(Date))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_country <- domexp_country %>% \n  select(Year, everything(), -Date)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_country <- domexp_country %>% \n  group_by(Year) %>%\n  summarise(across(where(is.numeric), sum, na.rm = TRUE))\n```\n:::\n\n\n### Continent Level\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_continent <- dom_exports[c(10, 12, 43, 85, 121, 136), ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(domexp_continent) <- domexp_continent[1, ]\ndomexp_continent <- domexp_continent[-1, ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_continent <- domexp_continent %>% \n  pivot_longer(cols = -1, names_to = \"Date\", values_to = \"Value\") %>% \n  pivot_wider(names_from = colnames(domexp_continent)[1], values_from = \"Value\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_continent$`Date` <- ym(\n  domexp_continent$`Date`\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_continent <- domexp_continent %>%\n  mutate(\n    across(-Date, as.numeric)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_continent <- domexp_continent %>% \n  mutate(Year = year(Date))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_continent <- domexp_continent %>% \n  select(Year, everything(), -Date)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndomexp_continent <- domexp_continent %>% \n  group_by(Year) %>%\n  summarise(across(where(is.numeric), sum, na.rm = TRUE))\n```\n:::\n\n:::\n\n### 2.3.3 Processing Re-Exports Data\n\n::: panel-tabset\n### Country Level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_country <- re_exports[-c(1:9, 11, 12, 43, 85, 121, 136, 171:191), ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(reexp_country) <- reexp_country[1, ]\nreexp_country <- reexp_country[-1, ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_country <- reexp_country %>% \n  pivot_longer(cols = -1, names_to = \"Date\", values_to = \"Value\") %>% \n  pivot_wider(names_from = colnames(reexp_country)[1], values_from = \"Value\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_country$`Date` <- ym(\n  reexp_country$`Date`\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_country <- reexp_country %>%\n  mutate(\n    across(-Date, as.numeric)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_country <- reexp_country %>% \n  mutate(Year = year(Date))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_country <- reexp_country %>% \n  select(Year, everything(), -Date)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_country <- reexp_country %>% \n  group_by(Year) %>%\n  summarise(across(where(is.numeric), sum, na.rm = TRUE))\n```\n:::\n\n\n### Continent Level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_continent <- re_exports[c(10, 12, 43, 85, 121, 136), ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(reexp_continent) <- reexp_continent[1, ]\nreexp_continent <- reexp_continent[-1, ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_continent <- reexp_continent %>% \n  pivot_longer(cols = -1, names_to = \"Date\", values_to = \"Value\") %>% \n  pivot_wider(names_from = colnames(reexp_continent)[1], values_from = \"Value\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_continent$`Date` <- ym(\n  reexp_continent$`Date`\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_continent <- reexp_continent %>%\n  mutate(\n    across(-Date, as.numeric)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_continent <- reexp_continent %>% \n  mutate(Year = year(Date))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_continent <- reexp_continent %>% \n  select(Year, everything(), -Date)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreexp_continent <- reexp_continent %>% \n  group_by(Year) %>%\n  summarise(across(where(is.numeric), sum, na.rm = TRUE))\n```\n:::\n\n:::\n\n### 2.3.4 Combining Domestic Exports and Re-Exports Data\n\nUsing the code chunk below, we will combine both domestic exports and re-exports data\n\n::: panel-tabset\n### Country\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexports_country <- domexp_country + reexp_country\nexports_country$Year <- domexp_country$Year\nexports_country <- exports_country %>% relocate(Year)\n```\n:::\n\n\n### Continent\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexports_continent <- domexp_continent + reexp_continent\nexports_continent$Year <- domexp_continent$Year\nexports_continent <- exports_continent %>% relocate(Year)\n```\n:::\n\n:::\n\n### 2.3.5 Joining Import and Export Data\n\n::: panel-tabset\n### Country Level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexports_country <- exports_country %>% mutate(Type = \"Exports\")\nimports_country <- imports_country %>% mutate(Type = \"Imports\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade_country <- bind_rows(exports_country, imports_country)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade_country <- trade_country %>% arrange(Year)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade_country <- trade_country %>% select(Year, Type, everything())\n```\n:::\n\n\n### Continent Level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexports_continent <- exports_continent %>% mutate(Type = \"Exports\")\nimports_continent <- imports_continent %>% mutate(Type = \"Imports\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade_continent <- bind_rows(exports_continent, imports_continent)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade_continent <- trade_continent %>% arrange(Year)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade_continent <- trade_continent %>% select(Year, Type, everything())\n```\n:::\n\n:::\n\n## 2.4 Save Data\n\nFor easier usage of cleaned dataframe, let us save it to csv file and load it to R environment\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(trade_country, \"data/trade_country.csv\", row.names = FALSE)\nwrite.csv(trade_continent, \"data/trade_continent.csv\", row.names = FALSE)\n```\n:::\n\n\n## 2.5 Load Final Data\n\nFinally, use the code below to load the final dataframe to R environment\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade_country <- read_csv(\"data/trade_country.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 46 Columns: 156\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (1): Type\ndbl (155): Year, Antigua And Barbuda, Argentina, Bahamas, Bermuda, Brazil, C...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade_continent <- read_csv(\"data/trade_continent.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 46 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Type\ndbl (6): Year, America, Asia, Europe, Oceania, Africa\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n# 3 Data Visualization\n\nTo begin with the imports and exports analysis, we are going to refer to the SingStat website to look up 3 visualisations that we find interesting. However, to enhance the analysis, we will comment the pros and cons of each visual reference and create an improved version of the visuals.\n\n## 3.1 Comments on Visualizations\n\nLet us begin this section with the pros and cons of 3 visualisations.\n\n### 3.1.1 Total Merchandise Trade at Current Price, 2020-2024\n\nLet us take a look at the first visualization for total merchandise trade in 2020-2024.\n\n::: panel-tabset\n### Original\n\nThe figure below is showing the total merchandise trade comparison for each year from 2020-2024. What could be improved from this data visualisation?\n\n![](images/clipboard-471416878.png)\n\n**Pros:**\n\n1.  The visual design of the horizontal bar chart fits the theme of the data presented, which helps audience understand the context efficiently\n2.  The data is sorted in descending order based on the year, showing the latest year data on top of the chart, which allows audience to view the most recent information first\n\n**Cons:**\n\n1.  The purpose of this chart is to compare the import and export of each year stated. However, the bar chart spacing does not indicate this comparison. To properly show the comparison, it should be visualized as clustered bar chart, where there is extra spacing for different years\n2.  Although the choice of color palette is aesthetically nice, the color for all \"imports\" and all \"exports\" should be consistent and the legend should be shown in the chart. The current color does not highlight the difference between import and export as it is the same color with different opacity level\n\n### Visual Make-Over\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade_summary <- trade_continent %>%\n  filter(Year >= 2020 & Year <= 2024) %>%  \n  group_by(Year, Type) %>%\n  summarise(Total = sum(America, Asia, Europe, Oceania, Africa, na.rm = TRUE), .groups = \"drop\")\n\ntrade_summary$Year <- factor(trade_summary$Year, levels = sort(unique(trade_summary$Year), decreasing = FALSE))\n\nggplot(trade_summary, aes(y = Year, x = Total / 1000, fill = Type)) +  \n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.6), width = 0.5) +  \n  scale_fill_manual(values = c(\"Exports\" = \"skyblue\", \"Imports\" = \"lightcoral\")) + \n  labs(title = \"OVERALL EXPORTS AND IMPORTS OF SERVICES, 2020-2024\",\n       x = \"S$ Billion\", y = \"Year\") +\n  theme_minimal(base_size = 14) +  \n  theme(\n    plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16), \n    legend.title = element_blank(),  \n    legend.position = \"bottom\",\n    plot.background = element_rect(fill = \"#E3ECF1\", color = NA)\n  ) +\n  geom_text(aes(label = round(Total / 1000, 1)), \n            position = position_dodge(width = 0.6), hjust = -0.3, size = 4, color = \"black\") +\n  geom_label(data = trade_summary %>% group_by(Year) %>%\n               summarise(Total = sum(Total) / 1000, .groups = \"drop\"), \n             aes(y = Year, x = 900,  \n                 label = paste0(\"Total: S$ \", round(Total, 1), \"B\")),\n             fill = \"white\", color = \"black\", fontface = \"bold\", size = 4, \n             label.size = 0.3, label.r = unit(5, \"pt\")) +\n  scale_x_continuous(limits = c(0, 1000),\n                     labels = scales::label_number())\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-67-1.png){width=768}\n:::\n:::\n\n\nWhat are the key improvements on this visual?\n\n1.  The colors are standardized for both imports and exports, it ensures a clear definition of imports value and exports value.\n2.  The charts are clustered and grouped in years, showing a significant gap between every year's data.\n:::\n\n### 3.1.2 Merchandise Trade Performance With Major Trading Partners, 2024\n\n::: panel-tabset\n### Original\n\nThe figure below represents the total merchandise trade of the top 10 countries in 2024. Let us discuss the pros and cons of the visual shown below.\n\n![](images/clipboard-2874159398.png)\n\n**Pros:**\n\n1.  The different bubble sizes that reflects the trade value with each country helps to highlight the countries with highest values more quickly.\n2.  The x-axis and y-axis range is symmetrical, showing accurate representations. Moreover, as the chart is diagonally split, it highlights whether the country has more export or import values.\n\n**Cons:**\n\n1.  The placement of x-label and y-label is too close and can be misleading at first sight. For better visualisation, the label should be put at the other end of the line to avoid misinterpretations.\n2.  The color representing each country does not give any significant insight. Instead,\n\n### Visual Make-Over\n\nBefore the make-over, let us do some data wrangling to match the original visualisation's data structure. First, let us filter to 2024 data using the code below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade <- trade_country %>% filter(Year == 2024)\n```\n:::\n\n\nAs the original visual shows the **European Union**, let us group all the countries that are part of the European Union.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neu_countries <- c('Austria', 'Belgium', 'Bulgaria', 'Croatia', 'Cyprus',\n                  'Czech Rep', 'Denmark', 'Estonia', 'Finland', 'France',\n                  'Germany', 'Greece', 'Hungary', 'Ireland', 'Italy', 'Latvia',\n                  'Lithuania', 'Luxembourg', 'Malta', 'Netherlands', 'Poland',\n                  'Portugal', 'Romania', 'Slovakia', 'Slovenia', 'Spain', \n                  'Svalbard And Jan Mayen Islands','Sweden')\n\ntrade$EU <- rowSums(trade[eu_countries])\n```\n:::\n\n\nNow, let us pivot back the data and change the values from millions to billions using the code below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade <- trade %>%\n  pivot_longer(cols = -c(Year, Type), names_to = \"Country\", values_to = \"value\") %>%\n  pivot_wider(names_from = Type, values_from = value) %>% \n  mutate(\n    Imports = Imports/1000,\n    Exports = Exports/1000\n  )\n```\n:::\n\n\nLet us define the color and the opacity of each country based on the imports or exports value. If exports value is higher, it will show green color, and blue if otherwise. The opacity represents how big the amount of the imports or exports in each country. The more solid the color, means the higher the trade value is.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade <- trade %>%\n  mutate(\n    total_trade = Imports + Exports,\n    color = ifelse(Exports > Imports, \n                   rgb(34/255, 139/255, 34/255, alpha = 1),\n                   rgb(70/255, 130/255, 180/255, alpha = 1)\n    ),\n    opacity = ifelse(Exports > Imports, \n                 0.5 + (0.7 * Exports / max(Exports, na.rm = TRUE)),\n                 0.5 + (0.7 * Imports / max(Imports, na.rm = TRUE)))\n\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrade <- trade %>% \n  arrange(desc(total_trade)) %>% \n  slice_head(n = 10) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(trade, aes(x = Exports, y = Imports)) +\n    geom_tile(data = expand.grid(x = seq(0, 100, by = 0.5),  \n                             y = seq(0, 100, by = 0.5)), \n          aes(x = x, y = y, fill = x > y), width = 0.5, height = 0.5, color = NA) +\n    scale_fill_manual(values = c(\n        \"TRUE\" = rgb(200/255, 255/255, 200/255, alpha = 0.2),\n        \"FALSE\" = rgb(173/255, 216/255, 230/255, alpha = 0.2)\n    )) +\n  \n    geom_point(aes(color = color, alpha = opacity), shape = 16, size = 5) +\n\n    geom_text(aes(label = paste(Country, \"\\n\", round(total_trade, 1))), \n              size = 4, color = \"black\", vjust = -0.5) +\n\n    geom_abline(intercept = 0, slope = 1, linetype = NA, size = 1) +\n    scale_x_continuous(limits = c(0, 100), breaks = seq(0, 100, 10), minor_breaks = NULL) +\n    scale_y_continuous(limits = c(0, 100), breaks = seq(0, 100, 10), minor_breaks = NULL) +\n    labs(x = \"Exports (S$ Billion)\", y = \"Imports (S$ Billion)\",\n         title = \"Merchandise Trade Performance With Major Trading Partners (2024)\") +\n    scale_color_identity() +\n    scale_alpha_continuous(range = c(0.1, 1)) +\n    theme_minimal() + \n    theme(\n        plot.title = element_text(hjust=0.5),\n        panel.grid.major = element_line(color = \"whitesmoke\", size = 0.4),\n        panel.grid.minor = element_blank(),\n        panel.background = element_rect(fill = \"transparent\", color = NA),\n        plot.background = element_rect(fill = \"transparent\", color = NA),\n        legend.position = \"none\"\n    )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.\nℹ Please use the `linewidth` argument instead.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 800 rows containing missing values or values outside the scale range\n(`geom_tile()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_segment()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-73-1.png){width=768}\n:::\n:::\n\n\nHow is this visual different from the original visualisation?\n\n1.  Instead of representing each country with different colors, each dot color represents whether the exports or imports value dominates the overall trade value, where green represents exports and blue represents imports\n2.  The opacity level shows how big the amount of exports or imports with each trading partners.\n3.  The x-label and y-label is re-positioned to avoid misinterpretation of axis values.\n:::\n\n### 3.1.3 Non-Oil Domestic Exports (2024)\n\n::: panel-tabset\n### Original\n\nNow let us have a look at the final visualisation, showing the non-oil domestic exports by major commodity sections in 2024. It shows the percentage of share of each non-oil goods trade category. Let us examine the pros and cons of the following visualisation.\n\n![](images/clipboard-3962379803.png)\n\n**Pros:**\n\n1.  The visual above shows a detailed insight of each non-oil goods, showing both trade values and the percentage of share clearly.\n2.  Each category is highlighted in different color palettes, highlighting different goods under non-oil category.\n\n**Cons:**\n\n1.  The data is stacked into one bar. Although it visually fits the concept of the data presented, the data only shows the data for year 2024, hence, it will be better if it is separated into different bars for better readability.\n2.  The values are not sorted and it is uses both left and right side of the bar chart. It is not very efficient for readers as it may take sometime to figure out the category of each bar stack. It also can be misleading as the value is in random order.\n\n### Visual Make-Over\n\n::: details Click to expand\n### Data Wrangling\n\nBefore showing the visual make-over, it is necessary to do some data wrangling as it is from different data source, which is the **Merchandise Trade by Commodity Section** **(At Current Price), Monthly** dataset. Let us prepare the data using the code below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnonoil <- read_csv(\"data/nonoil.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\nRows: 105 Columns: 734\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(734): ...1, ...2, ...3, ...4, ...5, ...6, ...7, ...8, ...9, ...10, ...1...\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -> `...1`\n• `` -> `...2`\n• `` -> `...3`\n• `` -> `...4`\n• `` -> `...5`\n• `` -> `...6`\n• `` -> `...7`\n• `` -> `...8`\n• `` -> `...9`\n• `` -> `...10`\n• `` -> `...11`\n• `` -> `...12`\n• `` -> `...13`\n• `` -> `...14`\n• `` -> `...15`\n• `` -> `...16`\n• `` -> `...17`\n• `` -> `...18`\n• `` -> `...19`\n• `` -> `...20`\n• `` -> `...21`\n• `` -> `...22`\n• `` -> `...23`\n• `` -> `...24`\n• `` -> `...25`\n• `` -> `...26`\n• `` -> `...27`\n• `` -> `...28`\n• `` -> `...29`\n• `` -> `...30`\n• `` -> `...31`\n• `` -> `...32`\n• `` -> `...33`\n• `` -> `...34`\n• `` -> `...35`\n• `` -> `...36`\n• `` -> `...37`\n• `` -> `...38`\n• `` -> `...39`\n• `` -> `...40`\n• `` -> `...41`\n• `` -> `...42`\n• `` -> `...43`\n• `` -> `...44`\n• `` -> `...45`\n• `` -> `...46`\n• `` -> `...47`\n• `` -> `...48`\n• `` -> `...49`\n• `` -> `...50`\n• `` -> `...51`\n• `` -> `...52`\n• `` -> `...53`\n• `` -> `...54`\n• `` -> `...55`\n• `` -> `...56`\n• `` -> `...57`\n• `` -> `...58`\n• `` -> `...59`\n• `` -> `...60`\n• `` -> `...61`\n• `` -> `...62`\n• `` -> `...63`\n• `` -> `...64`\n• `` -> `...65`\n• `` -> `...66`\n• `` -> `...67`\n• `` -> `...68`\n• `` -> `...69`\n• `` -> `...70`\n• `` -> `...71`\n• `` -> `...72`\n• `` -> `...73`\n• `` -> `...74`\n• `` -> `...75`\n• `` -> `...76`\n• `` -> `...77`\n• `` -> `...78`\n• `` -> `...79`\n• `` -> `...80`\n• `` -> `...81`\n• `` -> `...82`\n• `` -> `...83`\n• `` -> `...84`\n• `` -> `...85`\n• `` -> `...86`\n• `` -> `...87`\n• `` -> `...88`\n• `` -> `...89`\n• `` -> `...90`\n• `` -> `...91`\n• `` -> `...92`\n• `` -> `...93`\n• `` -> `...94`\n• `` -> `...95`\n• `` -> `...96`\n• `` -> `...97`\n• `` -> `...98`\n• `` -> `...99`\n• `` -> `...100`\n• `` -> `...101`\n• `` -> `...102`\n• `` -> `...103`\n• `` -> `...104`\n• `` -> `...105`\n• `` -> `...106`\n• `` -> `...107`\n• `` -> `...108`\n• `` -> `...109`\n• `` -> `...110`\n• `` -> `...111`\n• `` -> `...112`\n• `` -> `...113`\n• `` -> `...114`\n• `` -> `...115`\n• `` -> `...116`\n• `` -> `...117`\n• `` -> `...118`\n• `` -> `...119`\n• `` -> `...120`\n• `` -> `...121`\n• `` -> `...122`\n• `` -> `...123`\n• `` -> `...124`\n• `` -> `...125`\n• `` -> `...126`\n• `` -> `...127`\n• `` -> `...128`\n• `` -> `...129`\n• `` -> `...130`\n• `` -> `...131`\n• `` -> `...132`\n• `` -> `...133`\n• `` -> `...134`\n• `` -> `...135`\n• `` -> `...136`\n• `` -> `...137`\n• `` -> `...138`\n• `` -> `...139`\n• `` -> `...140`\n• `` -> `...141`\n• `` -> `...142`\n• `` -> `...143`\n• `` -> `...144`\n• `` -> `...145`\n• `` -> `...146`\n• `` -> `...147`\n• `` -> `...148`\n• `` -> `...149`\n• `` -> `...150`\n• `` -> `...151`\n• `` -> `...152`\n• `` -> `...153`\n• `` -> `...154`\n• `` -> `...155`\n• `` -> `...156`\n• `` -> `...157`\n• `` -> `...158`\n• `` -> `...159`\n• `` -> `...160`\n• `` -> `...161`\n• `` -> `...162`\n• `` -> `...163`\n• `` -> `...164`\n• `` -> `...165`\n• `` -> `...166`\n• `` -> `...167`\n• `` -> `...168`\n• `` -> `...169`\n• `` -> `...170`\n• `` -> `...171`\n• `` -> `...172`\n• `` -> `...173`\n• `` -> `...174`\n• `` -> `...175`\n• `` -> `...176`\n• `` -> `...177`\n• `` -> `...178`\n• `` -> `...179`\n• `` -> `...180`\n• `` -> `...181`\n• `` -> `...182`\n• `` -> `...183`\n• `` -> `...184`\n• `` -> `...185`\n• `` -> `...186`\n• `` -> `...187`\n• `` -> `...188`\n• `` -> `...189`\n• `` -> `...190`\n• `` -> `...191`\n• `` -> `...192`\n• `` -> `...193`\n• `` -> `...194`\n• `` -> `...195`\n• `` -> `...196`\n• `` -> `...197`\n• `` -> `...198`\n• `` -> `...199`\n• `` -> `...200`\n• `` -> `...201`\n• `` -> `...202`\n• `` -> `...203`\n• `` -> `...204`\n• `` -> `...205`\n• `` -> `...206`\n• `` -> `...207`\n• `` -> `...208`\n• `` -> `...209`\n• `` -> `...210`\n• `` -> `...211`\n• `` -> `...212`\n• `` -> `...213`\n• `` -> `...214`\n• `` -> `...215`\n• `` -> `...216`\n• `` -> `...217`\n• `` -> `...218`\n• `` -> `...219`\n• `` -> `...220`\n• `` -> `...221`\n• `` -> `...222`\n• `` -> `...223`\n• `` -> `...224`\n• `` -> `...225`\n• `` -> `...226`\n• `` -> `...227`\n• `` -> `...228`\n• `` -> `...229`\n• `` -> `...230`\n• `` -> `...231`\n• `` -> `...232`\n• `` -> `...233`\n• `` -> `...234`\n• `` -> `...235`\n• `` -> `...236`\n• `` -> `...237`\n• `` -> `...238`\n• `` -> `...239`\n• `` -> `...240`\n• `` -> `...241`\n• `` -> `...242`\n• `` -> `...243`\n• `` -> `...244`\n• `` -> `...245`\n• `` -> `...246`\n• `` -> `...247`\n• `` -> `...248`\n• `` -> `...249`\n• `` -> `...250`\n• `` -> `...251`\n• `` -> `...252`\n• `` -> `...253`\n• `` -> `...254`\n• `` -> `...255`\n• `` -> `...256`\n• `` -> `...257`\n• `` -> `...258`\n• `` -> `...259`\n• `` -> `...260`\n• `` -> `...261`\n• `` -> `...262`\n• `` -> `...263`\n• `` -> `...264`\n• `` -> `...265`\n• `` -> `...266`\n• `` -> `...267`\n• `` -> `...268`\n• `` -> `...269`\n• `` -> `...270`\n• `` -> `...271`\n• `` -> `...272`\n• `` -> `...273`\n• `` -> `...274`\n• `` -> `...275`\n• `` -> `...276`\n• `` -> `...277`\n• `` -> `...278`\n• `` -> `...279`\n• `` -> `...280`\n• `` -> `...281`\n• `` -> `...282`\n• `` -> `...283`\n• `` -> `...284`\n• `` -> `...285`\n• `` -> `...286`\n• `` -> `...287`\n• `` -> `...288`\n• `` -> `...289`\n• `` -> `...290`\n• `` -> `...291`\n• `` -> `...292`\n• `` -> `...293`\n• `` -> `...294`\n• `` -> `...295`\n• `` -> `...296`\n• `` -> `...297`\n• `` -> `...298`\n• `` -> `...299`\n• `` -> `...300`\n• `` -> `...301`\n• `` -> `...302`\n• `` -> `...303`\n• `` -> `...304`\n• `` -> `...305`\n• `` -> `...306`\n• `` -> `...307`\n• `` -> `...308`\n• `` -> `...309`\n• `` -> `...310`\n• `` -> `...311`\n• `` -> `...312`\n• `` -> `...313`\n• `` -> `...314`\n• `` -> `...315`\n• `` -> `...316`\n• `` -> `...317`\n• `` -> `...318`\n• `` -> `...319`\n• `` -> `...320`\n• `` -> `...321`\n• `` -> `...322`\n• `` -> `...323`\n• `` -> `...324`\n• `` -> `...325`\n• `` -> `...326`\n• `` -> `...327`\n• `` -> `...328`\n• `` -> `...329`\n• `` -> `...330`\n• `` -> `...331`\n• `` -> `...332`\n• `` -> `...333`\n• `` -> `...334`\n• `` -> `...335`\n• `` -> `...336`\n• `` -> `...337`\n• `` -> `...338`\n• `` -> `...339`\n• `` -> `...340`\n• `` -> `...341`\n• `` -> `...342`\n• `` -> `...343`\n• `` -> `...344`\n• `` -> `...345`\n• `` -> `...346`\n• `` -> `...347`\n• `` -> `...348`\n• `` -> `...349`\n• `` -> `...350`\n• `` -> `...351`\n• `` -> `...352`\n• `` -> `...353`\n• `` -> `...354`\n• `` -> `...355`\n• `` -> `...356`\n• `` -> `...357`\n• `` -> `...358`\n• `` -> `...359`\n• `` -> `...360`\n• `` -> `...361`\n• `` -> `...362`\n• `` -> `...363`\n• `` -> `...364`\n• `` -> `...365`\n• `` -> `...366`\n• `` -> `...367`\n• `` -> `...368`\n• `` -> `...369`\n• `` -> `...370`\n• `` -> `...371`\n• `` -> `...372`\n• `` -> `...373`\n• `` -> `...374`\n• `` -> `...375`\n• `` -> `...376`\n• `` -> `...377`\n• `` -> `...378`\n• `` -> `...379`\n• `` -> `...380`\n• `` -> `...381`\n• `` -> `...382`\n• `` -> `...383`\n• `` -> `...384`\n• `` -> `...385`\n• `` -> `...386`\n• `` -> `...387`\n• `` -> `...388`\n• `` -> `...389`\n• `` -> `...390`\n• `` -> `...391`\n• `` -> `...392`\n• `` -> `...393`\n• `` -> `...394`\n• `` -> `...395`\n• `` -> `...396`\n• `` -> `...397`\n• `` -> `...398`\n• `` -> `...399`\n• `` -> `...400`\n• `` -> `...401`\n• `` -> `...402`\n• `` -> `...403`\n• `` -> `...404`\n• `` -> `...405`\n• `` -> `...406`\n• `` -> `...407`\n• `` -> `...408`\n• `` -> `...409`\n• `` -> `...410`\n• `` -> `...411`\n• `` -> `...412`\n• `` -> `...413`\n• `` -> `...414`\n• `` -> `...415`\n• `` -> `...416`\n• `` -> `...417`\n• `` -> `...418`\n• `` -> `...419`\n• `` -> `...420`\n• `` -> `...421`\n• `` -> `...422`\n• `` -> `...423`\n• `` -> `...424`\n• `` -> `...425`\n• `` -> `...426`\n• `` -> `...427`\n• `` -> `...428`\n• `` -> `...429`\n• `` -> `...430`\n• `` -> `...431`\n• `` -> `...432`\n• `` -> `...433`\n• `` -> `...434`\n• `` -> `...435`\n• `` -> `...436`\n• `` -> `...437`\n• `` -> `...438`\n• `` -> `...439`\n• `` -> `...440`\n• `` -> `...441`\n• `` -> `...442`\n• `` -> `...443`\n• `` -> `...444`\n• `` -> `...445`\n• `` -> `...446`\n• `` -> `...447`\n• `` -> `...448`\n• `` -> `...449`\n• `` -> `...450`\n• `` -> `...451`\n• `` -> `...452`\n• `` -> `...453`\n• `` -> `...454`\n• `` -> `...455`\n• `` -> `...456`\n• `` -> `...457`\n• `` -> `...458`\n• `` -> `...459`\n• `` -> `...460`\n• `` -> `...461`\n• `` -> `...462`\n• `` -> `...463`\n• `` -> `...464`\n• `` -> `...465`\n• `` -> `...466`\n• `` -> `...467`\n• `` -> `...468`\n• `` -> `...469`\n• `` -> `...470`\n• `` -> `...471`\n• `` -> `...472`\n• `` -> `...473`\n• `` -> `...474`\n• `` -> `...475`\n• `` -> `...476`\n• `` -> `...477`\n• `` -> `...478`\n• `` -> `...479`\n• `` -> `...480`\n• `` -> `...481`\n• `` -> `...482`\n• `` -> `...483`\n• `` -> `...484`\n• `` -> `...485`\n• `` -> `...486`\n• `` -> `...487`\n• `` -> `...488`\n• `` -> `...489`\n• `` -> `...490`\n• `` -> `...491`\n• `` -> `...492`\n• `` -> `...493`\n• `` -> `...494`\n• `` -> `...495`\n• `` -> `...496`\n• `` -> `...497`\n• `` -> `...498`\n• `` -> `...499`\n• `` -> `...500`\n• `` -> `...501`\n• `` -> `...502`\n• `` -> `...503`\n• `` -> `...504`\n• `` -> `...505`\n• `` -> `...506`\n• `` -> `...507`\n• `` -> `...508`\n• `` -> `...509`\n• `` -> `...510`\n• `` -> `...511`\n• `` -> `...512`\n• `` -> `...513`\n• `` -> `...514`\n• `` -> `...515`\n• `` -> `...516`\n• `` -> `...517`\n• `` -> `...518`\n• `` -> `...519`\n• `` -> `...520`\n• `` -> `...521`\n• `` -> `...522`\n• `` -> `...523`\n• `` -> `...524`\n• `` -> `...525`\n• `` -> `...526`\n• `` -> `...527`\n• `` -> `...528`\n• `` -> `...529`\n• `` -> `...530`\n• `` -> `...531`\n• `` -> `...532`\n• `` -> `...533`\n• `` -> `...534`\n• `` -> `...535`\n• `` -> `...536`\n• `` -> `...537`\n• `` -> `...538`\n• `` -> `...539`\n• `` -> `...540`\n• `` -> `...541`\n• `` -> `...542`\n• `` -> `...543`\n• `` -> `...544`\n• `` -> `...545`\n• `` -> `...546`\n• `` -> `...547`\n• `` -> `...548`\n• `` -> `...549`\n• `` -> `...550`\n• `` -> `...551`\n• `` -> `...552`\n• `` -> `...553`\n• `` -> `...554`\n• `` -> `...555`\n• `` -> `...556`\n• `` -> `...557`\n• `` -> `...558`\n• `` -> `...559`\n• `` -> `...560`\n• `` -> `...561`\n• `` -> `...562`\n• `` -> `...563`\n• `` -> `...564`\n• `` -> `...565`\n• `` -> `...566`\n• `` -> `...567`\n• `` -> `...568`\n• `` -> `...569`\n• `` -> `...570`\n• `` -> `...571`\n• `` -> `...572`\n• `` -> `...573`\n• `` -> `...574`\n• `` -> `...575`\n• `` -> `...576`\n• `` -> `...577`\n• `` -> `...578`\n• `` -> `...579`\n• `` -> `...580`\n• `` -> `...581`\n• `` -> `...582`\n• `` -> `...583`\n• `` -> `...584`\n• `` -> `...585`\n• `` -> `...586`\n• `` -> `...587`\n• `` -> `...588`\n• `` -> `...589`\n• `` -> `...590`\n• `` -> `...591`\n• `` -> `...592`\n• `` -> `...593`\n• `` -> `...594`\n• `` -> `...595`\n• `` -> `...596`\n• `` -> `...597`\n• `` -> `...598`\n• `` -> `...599`\n• `` -> `...600`\n• `` -> `...601`\n• `` -> `...602`\n• `` -> `...603`\n• `` -> `...604`\n• `` -> `...605`\n• `` -> `...606`\n• `` -> `...607`\n• `` -> `...608`\n• `` -> `...609`\n• `` -> `...610`\n• `` -> `...611`\n• `` -> `...612`\n• `` -> `...613`\n• `` -> `...614`\n• `` -> `...615`\n• `` -> `...616`\n• `` -> `...617`\n• `` -> `...618`\n• `` -> `...619`\n• `` -> `...620`\n• `` -> `...621`\n• `` -> `...622`\n• `` -> `...623`\n• `` -> `...624`\n• `` -> `...625`\n• `` -> `...626`\n• `` -> `...627`\n• `` -> `...628`\n• `` -> `...629`\n• `` -> `...630`\n• `` -> `...631`\n• `` -> `...632`\n• `` -> `...633`\n• `` -> `...634`\n• `` -> `...635`\n• `` -> `...636`\n• `` -> `...637`\n• `` -> `...638`\n• `` -> `...639`\n• `` -> `...640`\n• `` -> `...641`\n• `` -> `...642`\n• `` -> `...643`\n• `` -> `...644`\n• `` -> `...645`\n• `` -> `...646`\n• `` -> `...647`\n• `` -> `...648`\n• `` -> `...649`\n• `` -> `...650`\n• `` -> `...651`\n• `` -> `...652`\n• `` -> `...653`\n• `` -> `...654`\n• `` -> `...655`\n• `` -> `...656`\n• `` -> `...657`\n• `` -> `...658`\n• `` -> `...659`\n• `` -> `...660`\n• `` -> `...661`\n• `` -> `...662`\n• `` -> `...663`\n• `` -> `...664`\n• `` -> `...665`\n• `` -> `...666`\n• `` -> `...667`\n• `` -> `...668`\n• `` -> `...669`\n• `` -> `...670`\n• `` -> `...671`\n• `` -> `...672`\n• `` -> `...673`\n• `` -> `...674`\n• `` -> `...675`\n• `` -> `...676`\n• `` -> `...677`\n• `` -> `...678`\n• `` -> `...679`\n• `` -> `...680`\n• `` -> `...681`\n• `` -> `...682`\n• `` -> `...683`\n• `` -> `...684`\n• `` -> `...685`\n• `` -> `...686`\n• `` -> `...687`\n• `` -> `...688`\n• `` -> `...689`\n• `` -> `...690`\n• `` -> `...691`\n• `` -> `...692`\n• `` -> `...693`\n• `` -> `...694`\n• `` -> `...695`\n• `` -> `...696`\n• `` -> `...697`\n• `` -> `...698`\n• `` -> `...699`\n• `` -> `...700`\n• `` -> `...701`\n• `` -> `...702`\n• `` -> `...703`\n• `` -> `...704`\n• `` -> `...705`\n• `` -> `...706`\n• `` -> `...707`\n• `` -> `...708`\n• `` -> `...709`\n• `` -> `...710`\n• `` -> `...711`\n• `` -> `...712`\n• `` -> `...713`\n• `` -> `...714`\n• `` -> `...715`\n• `` -> `...716`\n• `` -> `...717`\n• `` -> `...718`\n• `` -> `...719`\n• `` -> `...720`\n• `` -> `...721`\n• `` -> `...722`\n• `` -> `...723`\n• `` -> `...724`\n• `` -> `...725`\n• `` -> `...726`\n• `` -> `...727`\n• `` -> `...728`\n• `` -> `...729`\n• `` -> `...730`\n• `` -> `...731`\n• `` -> `...732`\n• `` -> `...733`\n• `` -> `...734`\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnonoil <- nonoil[c(10, 57:65), ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(nonoil) <- nonoil[1, ]\nnonoil <- nonoil[-1, ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnonoil <- nonoil[, -c(2, 15:ncol(nonoil))]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnonoil[,2:13] <- lapply(nonoil[,2:13], as.numeric)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnonoil$Total <- rowSums(nonoil[, 2:13])\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnonoil <- nonoil %>% \n  rename(Category = `Data Series`)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnonoil <- nonoil %>% \n  select(Category, Total)\n```\n:::\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnonoil <- nonoil %>%\n  mutate(Percentage = Total / sum(Total) * 100)\n\n# Compute total sum\ntotal_value <- sum(nonoil$Total)\n\n# Plot the bar chart\nggplot(nonoil, aes(x = reorder(Category, -Total), y = Total)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  \n  # Add labels showing value and percentage\n  geom_text(aes(label = paste0(Total, \" (\", round(Percentage, 1), \"%)\")),\n            vjust = -0.5, size = 5) +\n  \n  # Add total value at the top center\n  annotate(\"text\", x = 2, y = max(nonoil$Total) * 1.1, \n           label = paste(\"Total:\", total_value), \n           size = 6, fontface = \"bold\") +\n  \n  # Customize appearance\n  labs(title = \"Category Distribution\", x = \"Category\", y = \"Total Value\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\", size = 14),\n        axis.text.x = element_text(size = 12))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-82-1.png){width=672}\n:::\n:::\n\n:::\n",
    "supporting": [
      "Take-home_Ex02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}