{
  "hash": "a16f1e279812b400f55fe711baadb546",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1\"\nauthor: \"Brigitta Karen Tsai\"\ndate: \"February 8, 2025\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  message: false\n  freeze: true\n---\n\n\n# Ship Performance Analysis\n\n# 1 Overview\n\n## 1.1 The Background\n\nThe maritime industry plays a crucial role in supporting the global trade ecosystem, which serves as the primary mode for goods transportation. As it supports the international trading market, it is very important to pay more attention to the operational efficiency of the maritime industry. The purpose of this paper is to present the findings from shipping voyage data.\n\n## 1.2 The Data\n\nThe following are the details of the data source for this analysis:\n\n1.  Data Source: [Ship Performance Clustering Dataset](https://www.kaggle.com/datasets/jeleeladekunlefijabi/ship-performance-clustering-dataset)\n2.  Dataset Size: 18 columns x 2,736 rows\n3.  Data format: csv file\n\n## 1.3 The Task\n\nAs the graphical editor of the media company, an article about ship performance in the Gulf of Guinea will be written and published. Hence, this paper will include the following contents:\n\n1.  Exploratory Data Analysis of ship performance based on different underlying factors\n2.  Visualization of key operational metrics of the ship for future performance optimizations in the maritime industry\n\n# 2 Getting Started\n\n## 2.1 Load and Install Packages\n\nFor this analysis, **tidyverse** and **ggplot2** family packages will be used.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, ggrepel, patchwork, ggthemes, hrbrthemes, ggiraph,\n               plotly, DT, readxl, gifski, gapminder, gganimate, ggdist, ggridges,\n               colorspace, ggstatsplot, crosstalk, FunnelPlotR, knitr, scales,\n               corrplot)\n```\n:::\n\n\n## 2.2 Import Data\n\nImport ship performance dataset to get started with the analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nship <- read_csv(\"data/Ship.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 2736 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (5): Ship_Type, Route_Type, Engine_Type, Maintenance_Status, Weather_C...\ndbl  (12): Speed_Over_Ground_knots, Engine_Power_kW, Distance_Traveled_nm, D...\ndate  (1): Date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n# 3 Data Preparation\n\n## 3.1 Select Variables\n\nBefore we begin with the analysis, let us do some variable analysis and check the columns that we will be using for this analysis. Each row of the dataset represents the **performance metrics** and **attributes** for a specific **voyage/ship** over a given timeframe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(ship)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Date\"                    \"Ship_Type\"              \n [3] \"Route_Type\"              \"Engine_Type\"            \n [5] \"Maintenance_Status\"      \"Speed_Over_Ground_knots\"\n [7] \"Engine_Power_kW\"         \"Distance_Traveled_nm\"   \n [9] \"Draft_meters\"            \"Weather_Condition\"      \n[11] \"Cargo_Weight_tons\"       \"Operational_Cost_USD\"   \n[13] \"Revenue_per_Voyage_USD\"  \"Turnaround_Time_hours\"  \n[15] \"Efficiency_nm_per_kWh\"   \"Seasonal_Impact_Score\"  \n[17] \"Weekly_Voyage_Count\"     \"Average_Load_Percentage\"\n```\n\n\n:::\n:::\n\n\nFor easier read, let us list down all the columns in the table below to analyse the data types and the description.\n\n::: tabset-pane\n### Ship Dataframe\n\n::: {.table .table-striped .table-hover .table-bordered}\n| Column Name             | Type           | Description                              |\n|---------------------|-------------------|--------------------------------|\n| Date                    | date           | timestamp of data entry                  |\n| Ship_Type               | categorical    | types of vessel                          |\n| Route_Type              | categorical    | types of route                           |\n| Engine_Type             | categorical    | types of ship engine                     |\n| Maintenance_Status      | categorical    | current maintenance status               |\n| Speed_Over_Ground_knots | numerical      | average speed (knots)                    |\n| Engine_Power_kW         | numerical      | engine power output (kW)                 |\n| Distance_Traveled_nm    | numerical      | total distance travelled (nm)            |\n| Draft_meters            | numerical      | draft of the vessel (m)                  |\n| Weather_Condition       | categorical    | weather condition during operations      |\n| Cargo_Weight_tons       | numerical      | weight of goods on the ship (tons)       |\n| Operational_Cost_USD    | numerical      | total operational cost per voyage (USD)  |\n| Revenue_per_Voyage_USD  | numerical      | total revenue generated per voyage (USD) |\n| Turnaround_Time_hours   | numerical      | time taken per voyage (hours)            |\n| Efficiency_nm_per_kWh   | numerical      | energy efficiency (nm/kWh)               |\n| Seasonal_Impact_Score   | numerical      | *not listed in Kaggle*                   |\n| Weekly_Voyage_Count     | integer        | total no. of voyage per week             |\n| Average_Load_Percentage | percentage (%) | *not listed in Kaggle*                   |\n:::\n:::\n\n## 3.2 Remove Columns\n\nFrom the table, we will keep all the categorical and numerical columns to gain further insights on this dataset. There are 3 columns that we should remove from this dataset, which are **Date, Seasonal_Impact_Score** and **Average_Load_Percentage.**\n\n1.  **Date**: This column is removed because it only consists of the timestamp of the data entry, which is not necessarily value-add to this analysis.\n2.  **Seasonal_Impact_Score**: This column is removed because there is no description of how the value in this column is calculated. As there is no details on the column calculation, there will be no insights gained from analysing this column.\n3.  **Average_Load_Percentage**: This column is removed because there is no description and source of the column calculation, hence, there is no need to use this column for the analysis.\n\nThe 3 columns will be removed using the code chunk below:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nship <- ship %>% select(-c(\"Date\", \"Seasonal_Impact_Score\", \"Average_Load_Percentage\"))\n```\n:::\n\n\n## 3.3 Handling Missing Value\n\n### 3.3.1 Categorical Column\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(ship$Ship_Type)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  Bulk Carrier Container Ship   Fish Carrier           None         Tanker \n           669            635            653            136            643 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(ship$Route_Type)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n     Coastal    Long-haul         None   Short-haul Transoceanic \n         650          686          136          626          638 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(ship$Engine_Type)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n              Diesel Heavy Fuel Oil (HFO)                 None \n                 892                  853                  136 \n       Steam Turbine \n                 855 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(ship$Maintenance_Status)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCritical     Fair     Good     None \n     860      867      873      136 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(ship$Weather_Condition)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n    Calm Moderate     None    Rough \n     893      891      136      816 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nship <- ship[ship$Ship_Type != \"None\", ]\nship <- ship[ship$Route_Type != \"None\", ]\nship <- ship[ship$Engine_Type != \"None\", ]\nship <- ship[ship$Maintenance_Status != \"None\", ]\nship <- ship[ship$Weather_Condition != \"None\", ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndim(ship)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2127   15\n```\n\n\n:::\n:::\n\n\n### 3.3.2 Numerical Column\n\nIn this section, we will further clean numerical data type column to ensure the entire dataset is clean. The code chunks below will check the sum of null values of each numerical column.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(ship$Speed_Over_Ground_knots))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(ship$Engine_Power_kW))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(ship$Distance_Traveled_nm))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(ship$Draft_meters))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(ship$Cargo_Weight_tons))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(ship$Operational_Cost_USD))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(ship$Revenue_per_Voyage_USD))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(ship$Turnaround_Time_hours))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(ship$Efficiency_nm_per_kWh))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(ship$Weekly_Voyage_Count))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(ship)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 2,127\nColumns: 15\n$ Ship_Type               <chr> \"Fish Carrier\", \"Container Ship\", \"Bulk Carrie…\n$ Route_Type              <chr> \"Short-haul\", \"Long-haul\", \"Transoceanic\", \"Tr…\n$ Engine_Type             <chr> \"Steam Turbine\", \"Diesel\", \"Steam Turbine\", \"D…\n$ Maintenance_Status      <chr> \"Good\", \"Fair\", \"Fair\", \"Fair\", \"Fair\", \"Criti…\n$ Speed_Over_Ground_knots <dbl> 10.38758, 20.74975, 21.05510, 13.74278, 18.616…\n$ Engine_Power_kW         <dbl> 1796.0574, 1648.5567, 915.2618, 1089.7218, 217…\n$ Distance_Traveled_nm    <dbl> 1060.4864, 658.8741, 1126.8225, 1445.2812, 723…\n$ Draft_meters            <dbl> 14.653083, 7.199261, 11.789063, 9.727833, 14.9…\n$ Weather_Condition       <chr> \"Rough\", \"Moderate\", \"Moderate\", \"Moderate\", \"…\n$ Cargo_Weight_tons       <dbl> 162.3947, 178.0409, 1737.3853, 260.5951, 1912.…\n$ Operational_Cost_USD    <dbl> 483388.00, 448543.40, 261349.61, 287718.38, 18…\n$ Revenue_per_Voyage_USD  <dbl> 883765.79, 394018.75, 87551.38, 676121.46, 776…\n$ Turnaround_Time_hours   <dbl> 63.24820, 49.41815, 22.40911, 64.15823, 47.476…\n$ Efficiency_nm_per_kWh   <dbl> 0.2903614, 0.4995945, 0.7029057, 1.3313431, 1.…\n$ Weekly_Voyage_Count     <dbl> 6, 9, 1, 8, 7, 3, 6, 2, 9, 4, 3, 7, 7, 2, 4, 3…\n```\n\n\n:::\n:::\n\n\naverage operational cost per ship type, average revenue per ship type, stats of voyage per week\n\n## 3.4 Check for Outliers in Numerical Column\n\nThere are total of 10 numerical columns that we can use for our statistical analysis. In this section, we will do an individual column check to see whether there is outliers affecting the column of the dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot.stats(ship$Speed_Over_Ground_knots)$out\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnumeric(0)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot.stats(ship$Engine_Power_kW)$out\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnumeric(0)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot.stats(ship$Distance_Traveled_nm)$out\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnumeric(0)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot.stats(ship$Draft_meters)$out\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnumeric(0)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot.stats(ship$Operational_Cost_USD)$out\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnumeric(0)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot.stats(ship$Cargo_Weight_tons)$out\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnumeric(0)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot.stats(ship$Revenue_per_Voyage_USD)$out\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnumeric(0)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot.stats(ship$Turnaround_Time_hours)$out\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnumeric(0)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot.stats(ship$Efficiency_nm_per_kWh)$out\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnumeric(0)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot.stats(ship$Weekly_Voyage_Count)$out\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnumeric(0)\n```\n\n\n:::\n:::\n\n\nThe result from the codes above shows that there are no potential outliers affecting the dataset.\n\n## 3.5 Derive New Columns\n\nTo gain more insights on this analysis, let us derive a new column to find out the profit gained on each voyage of the ships. The code chunk below will use **mutate()** to derive the new column.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nship <- ship %>% \n  mutate(Profit_per_Voyage_USD = Revenue_per_Voyage_USD - Operational_Cost_USD)\n```\n:::\n\n\n# 4 Exploratory Data Analysis\n\n## 4.1 Profit Analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprofit <- ship[ship$Profit_per_Voyage_USD >= 0, ]\n```\n:::\n\n\nLet us plot a the distribution of profit earned per voyage using the histogram below.\n\n::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-09d75c74a4e92c56d4c1\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-09d75c74a4e92c56d4c1\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[28682.670554321492,28682.670554321376,28682.670554321376,28682.670554321492,28682.670554321492,28682.670554321376,28682.670554321376,28682.670554321376,28682.670554321376,28682.670554321376,28682.670554321434,28682.670554321376,28682.670554321376,28682.670554321434,28682.670554321434,28682.670554321376,28682.670554321376,28682.670554321434,28682.670554321434,28682.670554321376,28682.670554321376,28682.670554321492,28682.670554321376,28682.670554321376,28682.670554321376,28682.670554321376,28682.670554321492,28682.670554321376,28682.670554321376,28682.670554321492,28682.670554321376,28682.670554321376,28682.670554321376,28682.670554321259,28682.670554321492,28682.670554321492,28682.670554321259,28682.670554321492,28682.670554321259,28682.670554321492,28682.670554321492,28682.670554321259,28682.670554321492,28682.670554321492,28682.670554321259,28682.670554321492,28682.670554321259,28682.670554321492,28682.670554321492,28682.670554321259],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[-430240.0583148211,-401557.38776049967,-372874.71720617829,-344192.04665185686,-315509.37609753548,-286826.70554321405,-258144.03498889267,-229461.36443457124,-200778.69388024986,-172096.02332592843,-143413.35277160702,-114730.68221728562,-86048.011662964243,-57365.341108642839,-28682.670554321405,0,28682.670554321376,57365.34110864278,86048.011662964214,114730.68221728562,143413.35277160699,172096.02332592843,200778.69388024986,229461.36443457124,258144.03498889261,286826.70554321399,315509.37609753542,344192.04665185686,372874.71720617823,401557.38776049967,430240.0583148211,458922.72886914248,487605.39942346385,516288.06997778523,544970.7405321066,573653.4110864281,602336.08164074947,631018.75219507085,659701.42274939222,688384.0933037136,717066.76385803509,745749.43441235647,774432.10496667784,803114.77552099933,831797.44607532071,860480.11662964209,889162.78718396346,917845.45773828484,946528.12829260633,975210.7988469277],\"y\":[1,4,10,11,16,24,30,26,34,36,46,39,43,48,39,41,76,59,73,78,81,58,62,82,77,69,67,59,71,72,60,65,67,55,48,42,60,46,36,40,35,25,28,26,22,16,13,4,6,1],\"text\":[\"count:  1<br />Profit_per_Voyage_USD: -430240.06\",\"count:  4<br />Profit_per_Voyage_USD: -401557.39\",\"count: 10<br />Profit_per_Voyage_USD: -372874.72\",\"count: 11<br />Profit_per_Voyage_USD: -344192.05\",\"count: 16<br />Profit_per_Voyage_USD: -315509.38\",\"count: 24<br />Profit_per_Voyage_USD: -286826.71\",\"count: 30<br />Profit_per_Voyage_USD: -258144.03\",\"count: 26<br />Profit_per_Voyage_USD: -229461.36\",\"count: 34<br />Profit_per_Voyage_USD: -200778.69\",\"count: 36<br />Profit_per_Voyage_USD: -172096.02\",\"count: 46<br />Profit_per_Voyage_USD: -143413.35\",\"count: 39<br />Profit_per_Voyage_USD: -114730.68\",\"count: 43<br />Profit_per_Voyage_USD:  -86048.01\",\"count: 48<br />Profit_per_Voyage_USD:  -57365.34\",\"count: 39<br />Profit_per_Voyage_USD:  -28682.67\",\"count: 41<br />Profit_per_Voyage_USD:       0.00\",\"count: 76<br />Profit_per_Voyage_USD:   28682.67\",\"count: 59<br />Profit_per_Voyage_USD:   57365.34\",\"count: 73<br />Profit_per_Voyage_USD:   86048.01\",\"count: 78<br />Profit_per_Voyage_USD:  114730.68\",\"count: 81<br />Profit_per_Voyage_USD:  143413.35\",\"count: 58<br />Profit_per_Voyage_USD:  172096.02\",\"count: 62<br />Profit_per_Voyage_USD:  200778.69\",\"count: 82<br />Profit_per_Voyage_USD:  229461.36\",\"count: 77<br />Profit_per_Voyage_USD:  258144.03\",\"count: 69<br />Profit_per_Voyage_USD:  286826.71\",\"count: 67<br />Profit_per_Voyage_USD:  315509.38\",\"count: 59<br />Profit_per_Voyage_USD:  344192.05\",\"count: 71<br />Profit_per_Voyage_USD:  372874.72\",\"count: 72<br />Profit_per_Voyage_USD:  401557.39\",\"count: 60<br />Profit_per_Voyage_USD:  430240.06\",\"count: 65<br />Profit_per_Voyage_USD:  458922.73\",\"count: 67<br />Profit_per_Voyage_USD:  487605.40\",\"count: 55<br />Profit_per_Voyage_USD:  516288.07\",\"count: 48<br />Profit_per_Voyage_USD:  544970.74\",\"count: 42<br />Profit_per_Voyage_USD:  573653.41\",\"count: 60<br />Profit_per_Voyage_USD:  602336.08\",\"count: 46<br />Profit_per_Voyage_USD:  631018.75\",\"count: 36<br />Profit_per_Voyage_USD:  659701.42\",\"count: 40<br />Profit_per_Voyage_USD:  688384.09\",\"count: 35<br />Profit_per_Voyage_USD:  717066.76\",\"count: 25<br />Profit_per_Voyage_USD:  745749.43\",\"count: 28<br />Profit_per_Voyage_USD:  774432.10\",\"count: 26<br />Profit_per_Voyage_USD:  803114.78\",\"count: 22<br />Profit_per_Voyage_USD:  831797.45\",\"count: 16<br />Profit_per_Voyage_USD:  860480.12\",\"count: 13<br />Profit_per_Voyage_USD:  889162.79\",\"count:  4<br />Profit_per_Voyage_USD:  917845.46\",\"count:  6<br />Profit_per_Voyage_USD:  946528.13\",\"count:  1<br />Profit_per_Voyage_USD:  975210.80\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(190,190,190,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":37.260273972602747},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Profit Distribution of Ships per Voyage (USD)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-575000,1075000],\"tickmode\":\"array\",\"ticktext\":[\"-500,000\",\"-250,000\",\"0\",\"250,000\",\"500,000\",\"750,000\",\"1,000,000\"],\"tickvals\":[-500000,-250000,0,250000,500000,750000,1000000],\"categoryorder\":\"array\",\"categoryarray\":[\"-500,000\",\"-250,000\",\"0\",\"250,000\",\"500,000\",\"750,000\",\"1,000,000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Profit (USD)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-4,84],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"20\",\"40\",\"60\",\"80\"],\"tickvals\":[0,20,40,60,80],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"20\",\"40\",\"60\",\"80\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Count\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"3754472e18fd\":{\"x\":{},\"type\":\"bar\"}},\"cur_data\":\"3754472e18fd\",\"visdat\":{\"3754472e18fd\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nThe histogram shows a normal distribution ranging from USD -500,000 to USD 1,000,000. The distribution of profit is symmetrical with the highest count at USD 250,000. Normal distribution shows that it is uncommon to have a very high profit, and it is also uncommon to get extreme losses from ship journey. The x-axis shows there are presence of negative profit value, ranging from USD 0 to USD -500,000. Although the occurrence is not as often, is is still a questionable event of why certain ships incur losses in the ship operations. The histogram roughly highlights financial variability in the ship and maritime industry.\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv1 <- ggplot(data = ship, aes(x = Profit_per_Voyage_USD)) + \n  geom_histogram(bins = 50,\n                 color = \"black\",\n                 fill = \"grey\") + \n  coord_cartesian(xlim=c(-500000,1000000),\n                  ylim=c(0,80)) + \n  scale_x_continuous(\"Profit (USD)\",               \n                     breaks = seq(-500000, 1000000, by = 250000),\n                     labels = scales::comma) +\n  labs(\n    title = \"Profit Distribution of Ships per Voyage (USD)\",\n    y = \"Count\"\n  ) + \n  theme_minimal()\n\nggplotly(v1)\n```\n:::\n\n:::\n\n## 4.2 Loss Analysis\n\n### 4.2.1 Loss Incurred by Ship Types\n\nAfter the distribution plot, we are interested to find out the reason of loss incurred in the maritime industry. Let us create a new dataframe to do further analysis on the losses.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloss <- ship[ship$Profit_per_Voyage_USD < 0, ]\n```\n:::\n\n\n::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"girafe html-widget html-fill-item\" id=\"htmlwidget-aa4b9f568a975e205e42\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-aa4b9f568a975e205e42\">{\"x\":{\"html\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='ggiraph-svg' role='graphics-document' id='svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13' viewBox='0 0 576 355.97'>\\n <defs id='svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13_defs'>\\n  <clipPath id='svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13_c1'>\\n   <rect x='0' y='0' width='576' height='355.97'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13_c2'>\\n   <rect x='55.65' y='23.18' width='514.87' height='301.29'/>\\n  <\\/clipPath>\\n <\\/defs>\\n <g id='svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13_rootg' class='ggiraph-svg-rootg'>\\n  <g clip-path='url(#svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13_c1)'>\\n   <rect x='0' y='0' width='576' height='355.97' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.75' stroke-linejoin='round' stroke-linecap='round' class='ggiraph-svg-bg'/>\\n   <rect x='0' y='0' width='576' height='355.97' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='round'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13_c2)'>\\n   <rect x='55.65' y='23.18' width='514.87' height='301.29' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\\n   <polyline points='55.65,287.52 570.52,287.52' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='55.65,215.90 570.52,215.90' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='55.65,144.29 570.52,144.29' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='55.65,72.68 570.52,72.68' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='55.65,323.32 570.52,323.32' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='55.65,251.71 570.52,251.71' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='55.65,180.10 570.52,180.10' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='55.65,108.49 570.52,108.49' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='55.65,36.87 570.52,36.87' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='129.20,324.47 129.20,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='251.79,324.47 251.79,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='374.38,324.47 374.38,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='496.97,324.47 496.97,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <rect id='svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13_e1' x='74.04' y='36.87' width='110.33' height='259.32' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Mean Loss: -181 054.62 +/- 10 185.12'/>\\n   <rect id='svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13_e2' x='196.63' y='36.87' width='110.33' height='210.72' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Mean Loss: -147 125.85 +/- 8 853.60'/>\\n   <rect id='svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13_e3' x='319.22' y='36.87' width='110.33' height='232.36' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Mean Loss: -162 236.94 +/- 11 304.02'/>\\n   <rect id='svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13_e4' x='441.8' y='36.87' width='110.33' height='200.67' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Mean Loss: -140 107.21 +/- 8 690.47'/>\\n   <polyline points='116.95,281.60 141.46,281.60' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='129.20,281.60 129.20,310.78' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='116.95,310.78 141.46,310.78' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='239.53,234.91 264.05,234.91' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='251.79,234.91 251.79,260.27' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='239.53,260.27 264.05,260.27' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='362.12,253.05 386.64,253.05' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='374.38,253.05 374.38,285.43' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='362.12,285.43 386.64,285.43' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='484.71,225.09 509.23,225.09' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='496.97,225.09 496.97,249.99' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='484.71,249.99 509.23,249.99' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13_c1)'>\\n   <text x='18.41' y='326.47' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>-200000<\\/text>\\n   <text x='18.41' y='254.86' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>-150000<\\/text>\\n   <text x='18.41' y='183.25' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>-100000<\\/text>\\n   <text x='23.31' y='111.64' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>-50000<\\/text>\\n   <text x='45.82' y='40.02' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>0<\\/text>\\n   <polyline points='52.91,323.32 55.65,323.32' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='52.91,251.71 55.65,251.71' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='52.91,180.10 55.65,180.10' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='52.91,108.49 55.65,108.49' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='52.91,36.87 55.65,36.87' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='129.20,327.21 129.20,324.47' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='251.79,327.21 251.79,324.47' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='374.38,327.21 374.38,324.47' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='496.97,327.21 496.97,324.47' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text x='105.98' y='335.7' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Bulk Carrier<\\/text>\\n   <text x='222.68' y='335.7' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Container Ship<\\/text>\\n   <text x='351.41' y='335.7' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Fish Carrier<\\/text>\\n   <text x='483.76' y='335.7' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Tanker<\\/text>\\n   <text x='288.72' y='348.17' font-size='8.25pt' font-family='Arial'>Ship Type<\\/text>\\n   <text transform='translate(13.36,245.99) rotate(-90.00)' font-size='8.25pt' font-family='Arial'>Profit/Loss per Voyage (USD)<\\/text>\\n   <text x='55.65' y='14.93' font-size='9.9pt' font-family='Arial'>Loss per Voyage by Ship Type<\\/text>\\n  <\\/g>\\n <\\/g>\\n<\\/svg>\",\"js\":null,\"uid\":\"svg_122f7593_4bcc_4c0d_bf5b_d66237b06d13\",\"ratio\":1.618122977346278,\"settings\":{\"tooltip\":{\"css\":\".tooltip_SVGID_ { padding:5px;background:black;color:white;border-radius:2px;text-align:left; ; position:absolute;pointer-events:none;z-index:999;}\",\"placement\":\"doc\",\"opacity\":0.9,\"offx\":10,\"offy\":10,\"use_cursor_pos\":true,\"use_fill\":false,\"use_stroke\":false,\"delay_over\":200,\"delay_out\":500},\"hover\":{\"css\":\".hover_data_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_data_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_data_SVGID_ { fill:orange;stroke:black; }\\nline.hover_data_SVGID_, polyline.hover_data_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_data_SVGID_, polygon.hover_data_SVGID_, path.hover_data_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_data_SVGID_ { stroke:orange; }\",\"reactive\":true,\"nearest_distance\":null},\"hover_inv\":{\"css\":\"\"},\"hover_key\":{\"css\":\".hover_key_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_key_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_key_SVGID_ { fill:orange;stroke:black; }\\nline.hover_key_SVGID_, polyline.hover_key_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_key_SVGID_, polygon.hover_key_SVGID_, path.hover_key_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_key_SVGID_ { stroke:orange; }\",\"reactive\":true},\"hover_theme\":{\"css\":\".hover_theme_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_theme_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_theme_SVGID_ { fill:orange;stroke:black; }\\nline.hover_theme_SVGID_, polyline.hover_theme_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_theme_SVGID_, polygon.hover_theme_SVGID_, path.hover_theme_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_theme_SVGID_ { stroke:orange; }\",\"reactive\":true},\"select\":{\"css\":\".select_data_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_data_SVGID_ { stroke:none;fill:red; }\\ncircle.select_data_SVGID_ { fill:red;stroke:black; }\\nline.select_data_SVGID_, polyline.select_data_SVGID_ { fill:none;stroke:red; }\\nrect.select_data_SVGID_, polygon.select_data_SVGID_, path.select_data_SVGID_ { fill:red;stroke:none; }\\nimage.select_data_SVGID_ { stroke:red; }\",\"type\":\"multiple\",\"only_shiny\":true,\"selected\":[]},\"select_inv\":{\"css\":\"\"},\"select_key\":{\"css\":\".select_key_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_key_SVGID_ { stroke:none;fill:red; }\\ncircle.select_key_SVGID_ { fill:red;stroke:black; }\\nline.select_key_SVGID_, polyline.select_key_SVGID_ { fill:none;stroke:red; }\\nrect.select_key_SVGID_, polygon.select_key_SVGID_, path.select_key_SVGID_ { fill:red;stroke:none; }\\nimage.select_key_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"select_theme\":{\"css\":\".select_theme_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_theme_SVGID_ { stroke:none;fill:red; }\\ncircle.select_theme_SVGID_ { fill:red;stroke:black; }\\nline.select_theme_SVGID_, polyline.select_theme_SVGID_ { fill:none;stroke:red; }\\nrect.select_theme_SVGID_, polygon.select_theme_SVGID_, path.select_theme_SVGID_ { fill:red;stroke:none; }\\nimage.select_theme_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"zoom\":{\"min\":1,\"max\":1,\"duration\":300},\"toolbar\":{\"position\":\"topright\",\"pngname\":\"diagram\",\"tooltips\":null,\"fixed\":false,\"hidden\":[],\"delay_over\":200,\"delay_out\":500},\"sizing\":{\"rescale\":true,\"width\":1}}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nThe plot suggests that bulk carrier incurs the most losses as compared to other types of ship. Bulk carrier has a mean loss of **USD 181,054** with a margin of error of USD 10,185. Other ship types incur a mean loss ranging from USD 140,000 to 160,000. From this plot, we are curious on why bulk carriers incur such a big loss in operating their ship.\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntooltip <- function(y, ymax, accuracy = .01) {\n  mean <- scales::number(y, accuracy = accuracy)\n  sem <- scales::number(ymax - y, accuracy = accuracy)\n  paste(\"Mean Loss:\", mean, \"+/-\", sem)\n}\n\nv2 <- ggplot(data=loss, \n                   aes(x = Ship_Type),\n) +\n  stat_summary(aes(y = Profit_per_Voyage_USD, \n                   tooltip = after_stat(  \n                     tooltip(y, ymax))),  \n    fun.data = \"mean_se\", \n    geom = GeomInteractiveCol,  \n    fill = \"light blue\"\n  ) +\n  stat_summary(aes(y = Profit_per_Voyage_USD),\n    fun.data = mean_se,\n    geom = \"errorbar\", width = 0.2, size = 0.2\n  ) + \n  labs(\n    title = \"Loss per Voyage by Ship Type\",\n    x = \"Ship Type\",\n    y = \"Profit/Loss per Voyage (USD)\"\n  )\n\ngirafe(ggobj = v2,\n       width_svg = 8,\n       height_svg = 8*0.618)\n```\n:::\n\n:::\n\n### 4.2.2 Bulk Carrier Analysis\n\nFrom the previous plot, we want to further deep dive into bulk carrier ship to find out the reason of such a big loss in operating this ship. Hence, let us derive a new dataframe by filtering out only the bulk carriers data using the code below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbc <- ship[ship$Ship_Type == \"Bulk Carrier\",]\n```\n:::\n\n\n::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-41-1.png){width=1152}\n:::\n:::\n\n\nThere are 3 types of engines that could be used to operate a bulk carrier, **Steam Turbine**, **Heavy Fuel Oil** and **Diesel**. The boxplot suggests that, on average, it requires more cost to use Heavy Fuel Oil. The half eye graph shows the distribution shape of the operational cost. Heavy Fuel Oil and Steam Turbine have higher peaks, while Diesel has lower density distribution. This means that the cost of using Diesel is more spread out as compared to other engine types.\n\n### Code\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-42-1.png){width=1152}\n:::\n:::\n\n:::\n\n## 4.3 Ship Type and Route Type Analysis\n\n### 4.3.1 Loss Incurred by Each Ship Type and Route Type\n\nIn this section, we will further breakdown each ship type according to the route type and analyse the profit and loss incurred from each voyage.\n\n::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-335f95907210a032abed\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-335f95907210a032abed\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.17500000000000004,0.17500000000000027,0.17499999999999982,0.17499999999999982],\"base\":[0,0,0,0],\"x\":[0.73750000000000004,1.7375,2.7374999999999998,3.7374999999999998],\"y\":[31,22,22,27],\"text\":[\"count: 31<br />Ship_Type: Bulk Carrier<br />Route_Type: Coastal\",\"count: 22<br />Ship_Type: Container Ship<br />Route_Type: Coastal\",\"count: 22<br />Ship_Type: Fish Carrier<br />Route_Type: Coastal\",\"count: 27<br />Ship_Type: Tanker<br />Route_Type: Coastal\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(70,130,180,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Coastal\",\"legendgroup\":\"Coastal\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.17500000000000004,0.17499999999999982,0.17499999999999982,0.17499999999999982],\"base\":[0,0,0,0],\"x\":[0.91249999999999998,1.9125000000000001,2.9125000000000001,3.9125000000000001],\"y\":[21,42,22,28],\"text\":[\"count: 21<br />Ship_Type: Bulk Carrier<br />Route_Type: Long-haul\",\"count: 42<br />Ship_Type: Container Ship<br />Route_Type: Long-haul\",\"count: 22<br />Ship_Type: Fish Carrier<br />Route_Type: Long-haul\",\"count: 28<br />Ship_Type: Tanker<br />Route_Type: Long-haul\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Long-haul\",\"legendgroup\":\"Long-haul\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.17499999999999993,0.17499999999999982,0.17499999999999982,0.17500000000000071],\"base\":[0,0,0,0],\"x\":[1.0874999999999999,2.0874999999999999,3.0874999999999999,4.0875000000000004],\"y\":[29,20,24,29],\"text\":[\"count: 29<br />Ship_Type: Bulk Carrier<br />Route_Type: Short-haul\",\"count: 20<br />Ship_Type: Container Ship<br />Route_Type: Short-haul\",\"count: 24<br />Ship_Type: Fish Carrier<br />Route_Type: Short-haul\",\"count: 29<br />Ship_Type: Tanker<br />Route_Type: Short-haul\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(47,79,79,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Short-haul\",\"legendgroup\":\"Short-haul\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.17499999999999982,0.17499999999999982,0.17499999999999982,0.17500000000000071],\"base\":[0,0,0,0],\"x\":[1.2625,2.2625000000000002,3.2625000000000002,4.2625000000000002],\"y\":[26,29,24,27],\"text\":[\"count: 26<br />Ship_Type: Bulk Carrier<br />Route_Type: Transoceanic\",\"count: 29<br />Ship_Type: Container Ship<br />Route_Type: Transoceanic\",\"count: 24<br />Ship_Type: Fish Carrier<br />Route_Type: Transoceanic\",\"count: 27<br />Ship_Type: Tanker<br />Route_Type: Transoceanic\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(176,196,222,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Transoceanic\",\"legendgroup\":\"Transoceanic\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":110.31963470319637,\"l\":37.260273972602747},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Ship Type Distribution by Route Type that Incurred Loss\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Bulk Carrier\",\"Container Ship\",\"Fish Carrier\",\"Tanker\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Bulk Carrier\",\"Container Ship\",\"Fish Carrier\",\"Tanker\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-90,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Ship Type\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-2.5,52.5],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"10\",\"20\",\"30\",\"40\",\"50\"],\"tickvals\":[0,10,20,30,40,50],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"10\",\"20\",\"30\",\"40\",\"50\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Count\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Route_Type\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"3754ddb1121\":{\"x\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"3754ddb1121\",\"visdat\":{\"3754ddb1121\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nThis code visualizes the count of ship type by each route type that incurred losses during the ship operations. The chart suggests that container ship that uses long-haul route incurred the most losses as compared to other types of route. The second most loss incurred is bulk carrier that uses coastal route and also short-haul. Container ships and bulk carrier typically weighs significantly higher than other types of ship. Hence, the high operational cost that outweighs the revenue of the ship operations.\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv4 <- ggplot(data = loss, \n            aes(x = Ship_Type, fill = Route_Type)) +\n  geom_bar(stat = \"count\", \n           position = \"dodge\", \n           width = 0.7) +\n  scale_y_continuous(limits = c(0, 50)) +\n  scale_fill_manual(values = c(\"steelblue\", \"slategray\", \"darkslategray\", \"lightsteelblue\")) +\n  theme_minimal() +\n  labs(x = \"Ship Type\", \n       y = \"Count\", \n       title = \"Ship Type Distribution by Route Type that Incurred Loss\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nggplotly(v4)\n```\n:::\n\n:::\n\n### 4.3.2 Operational Cost\n\nAccording to the previous plot, container ship has the most count of ship operations that incurred losses. Hence, we are interested to find out the operational cost distribution of each type of ships from all the data entry that has higher cost than revenue.\n\n::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n\nThe half eye distribution shows that container ship graph is skewed to the left and has higher count for operational cost above the median point. While bulk carrier and fish carrier distribution is also heavily left-skewed, the median point is still lower than container ship's data.\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv5 <- ggplot(loss, \n       aes(x = Ship_Type, \n           y = Operational_Cost_USD)) +\n  stat_halfeye(adjust = 0.5,\n               justification = -0.2,\n               .width = 0,\n               point_colour = NA,\n               position = position_nudge(x = -0.2)) +\n  geom_boxplot(width = .20,\n               outlier.shape = NA) +\n  scale_y_continuous(\"Operational Cost (USD)\",               \n                     breaks = seq(0, 500000, by = 100000),\n                     labels = scales::comma) +\n  labs(\n    title = \"Operational Cost Distribution of Bulk Carrier by Engine Type (USD)\"\n  ) + \n  coord_flip() +\n  theme_minimal()\n\nv5\n```\n:::\n\n:::\n\n### 4.3.3 Mean Weights of Goods in the Ship\n\nAccording to the previous figure, we have concluded that the high operational cost of container ship and bulk carrier could be due to the cargo weights, which results in more maintenance needs or machine requirements. Hence, we will plot a visual to see whether container ships and bulk carriers has significantly more weights.\n\n::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"girafe html-widget html-fill-item\" id=\"htmlwidget-15b0ea0a1ba0dcda2890\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-15b0ea0a1ba0dcda2890\">{\"x\":{\"html\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='ggiraph-svg' role='graphics-document' id='svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff' viewBox='0 0 576 355.97'>\\n <defs id='svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff_defs'>\\n  <clipPath id='svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff_c1'>\\n   <rect x='0' y='0' width='576' height='355.97'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff_c2'>\\n   <rect x='42.93' y='23.18' width='527.59' height='301.29'/>\\n  <\\/clipPath>\\n <\\/defs>\\n <g id='svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff_rootg' class='ggiraph-svg-rootg'>\\n  <g clip-path='url(#svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff_c1)'>\\n   <rect x='0' y='0' width='576' height='355.97' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.75' stroke-linejoin='round' stroke-linecap='round' class='ggiraph-svg-bg'/>\\n   <rect x='0' y='0' width='576' height='355.97' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='round'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff_c2)'>\\n   <rect x='42.93' y='23.18' width='527.59' height='301.29' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\\n   <polyline points='42.93,275.23 570.52,275.23' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='42.93,204.15 570.52,204.15' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='42.93,133.06 570.52,133.06' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='42.93,61.98 570.52,61.98' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='42.93,310.78 570.52,310.78' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='42.93,239.69 570.52,239.69' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='42.93,168.61 570.52,168.61' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='42.93,97.52 570.52,97.52' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='42.93,26.43 570.52,26.43' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='118.30,324.47 118.30,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='243.92,324.47 243.92,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='369.53,324.47 369.53,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='495.15,324.47 495.15,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <rect id='svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff_e1' x='61.77' y='87.37' width='113.06' height='223.41' fill='#4682B4' fill-opacity='1' stroke='none' title='Mean Weight: 942.84 +/- 52.99'/>\\n   <rect id='svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff_e2' x='187.39' y='94.63' width='113.06' height='216.15' fill='#4682B4' fill-opacity='1' stroke='none' title='Mean Weight: 912.20 +/- 53.57'/>\\n   <rect id='svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff_e3' x='313.01' y='51.96' width='113.06' height='258.82' fill='#4682B4' fill-opacity='1' stroke='none' title='Mean Weight: 1 092.29 +/- 63.66'/>\\n   <rect id='svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff_e4' x='438.62' y='80.01' width='113.06' height='230.77' fill='#4682B4' fill-opacity='1' stroke='none' title='Mean Weight: 973.91 +/- 51.42'/>\\n   <polyline points='105.74,74.81 130.86,74.81' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='118.30,74.81 118.30,99.92' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='105.74,99.92 130.86,99.92' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='231.36,81.94 256.48,81.94' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='243.92,81.94 243.92,107.32' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='231.36,107.32 256.48,107.32' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='356.97,36.87 382.10,36.87' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='369.53,36.87 369.53,67.04' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='356.97,67.04 382.10,67.04' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='482.59,67.82 507.71,67.82' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='495.15,67.82 495.15,92.19' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='482.59,92.19 507.71,92.19' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff_c1)'>\\n   <text x='33.1' y='313.93' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>0<\\/text>\\n   <text x='23.31' y='242.84' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>300<\\/text>\\n   <text x='23.31' y='171.76' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>600<\\/text>\\n   <text x='23.31' y='100.67' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>900<\\/text>\\n   <text x='18.41' y='29.58' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>1200<\\/text>\\n   <polyline points='40.19,310.78 42.93,310.78' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='40.19,239.69 42.93,239.69' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='40.19,168.61 42.93,168.61' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='40.19,97.52 42.93,97.52' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='40.19,26.43 42.93,26.43' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='118.30,327.21 118.30,324.47' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='243.92,327.21 243.92,324.47' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='369.53,327.21 369.53,324.47' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='495.15,327.21 495.15,324.47' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text x='95.08' y='335.7' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Bulk Carrier<\\/text>\\n   <text x='214.81' y='335.7' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Container Ship<\\/text>\\n   <text x='346.56' y='335.7' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Fish Carrier<\\/text>\\n   <text x='481.94' y='335.7' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Tanker<\\/text>\\n   <text x='282.36' y='348.17' font-size='8.25pt' font-family='Arial'>Ship Type<\\/text>\\n   <text transform='translate(13.36,206.44) rotate(-90.00)' font-size='8.25pt' font-family='Arial'>Weight (tons)<\\/text>\\n   <text x='42.93' y='14.93' font-size='9.9pt' font-family='Arial'>Mean Weights of Ship Types that Incurred Loss<\\/text>\\n  <\\/g>\\n <\\/g>\\n<\\/svg>\",\"js\":null,\"uid\":\"svg_0303acb3_c561_45e6_a8ff_3bdda84fdfff\",\"ratio\":1.618122977346278,\"settings\":{\"tooltip\":{\"css\":\".tooltip_SVGID_ { padding:5px;background:black;color:white;border-radius:2px;text-align:left; ; position:absolute;pointer-events:none;z-index:999;}\",\"placement\":\"doc\",\"opacity\":0.9,\"offx\":10,\"offy\":10,\"use_cursor_pos\":true,\"use_fill\":false,\"use_stroke\":false,\"delay_over\":200,\"delay_out\":500},\"hover\":{\"css\":\".hover_data_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_data_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_data_SVGID_ { fill:orange;stroke:black; }\\nline.hover_data_SVGID_, polyline.hover_data_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_data_SVGID_, polygon.hover_data_SVGID_, path.hover_data_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_data_SVGID_ { stroke:orange; }\",\"reactive\":true,\"nearest_distance\":null},\"hover_inv\":{\"css\":\"\"},\"hover_key\":{\"css\":\".hover_key_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_key_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_key_SVGID_ { fill:orange;stroke:black; }\\nline.hover_key_SVGID_, polyline.hover_key_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_key_SVGID_, polygon.hover_key_SVGID_, path.hover_key_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_key_SVGID_ { stroke:orange; }\",\"reactive\":true},\"hover_theme\":{\"css\":\".hover_theme_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_theme_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_theme_SVGID_ { fill:orange;stroke:black; }\\nline.hover_theme_SVGID_, polyline.hover_theme_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_theme_SVGID_, polygon.hover_theme_SVGID_, path.hover_theme_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_theme_SVGID_ { stroke:orange; }\",\"reactive\":true},\"select\":{\"css\":\".select_data_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_data_SVGID_ { stroke:none;fill:red; }\\ncircle.select_data_SVGID_ { fill:red;stroke:black; }\\nline.select_data_SVGID_, polyline.select_data_SVGID_ { fill:none;stroke:red; }\\nrect.select_data_SVGID_, polygon.select_data_SVGID_, path.select_data_SVGID_ { fill:red;stroke:none; }\\nimage.select_data_SVGID_ { stroke:red; }\",\"type\":\"multiple\",\"only_shiny\":true,\"selected\":[]},\"select_inv\":{\"css\":\"\"},\"select_key\":{\"css\":\".select_key_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_key_SVGID_ { stroke:none;fill:red; }\\ncircle.select_key_SVGID_ { fill:red;stroke:black; }\\nline.select_key_SVGID_, polyline.select_key_SVGID_ { fill:none;stroke:red; }\\nrect.select_key_SVGID_, polygon.select_key_SVGID_, path.select_key_SVGID_ { fill:red;stroke:none; }\\nimage.select_key_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"select_theme\":{\"css\":\".select_theme_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_theme_SVGID_ { stroke:none;fill:red; }\\ncircle.select_theme_SVGID_ { fill:red;stroke:black; }\\nline.select_theme_SVGID_, polyline.select_theme_SVGID_ { fill:none;stroke:red; }\\nrect.select_theme_SVGID_, polygon.select_theme_SVGID_, path.select_theme_SVGID_ { fill:red;stroke:none; }\\nimage.select_theme_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"zoom\":{\"min\":1,\"max\":1,\"duration\":300},\"toolbar\":{\"position\":\"topright\",\"pngname\":\"diagram\",\"tooltips\":null,\"fixed\":false,\"hidden\":[],\"delay_over\":200,\"delay_out\":500},\"sizing\":{\"rescale\":true,\"width\":1}}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nThe plot above proves that container ship and bulk carrier don't have the highest weight. In fact, fish carrier has the highest mean weight as compared to the other ship types. This means that the cause of high operational cost of container ship and bulk carrier could be due to other possible reasons.\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntooltip <- function(y, ymax, accuracy = .01) {\n  mean <- scales::number(y, accuracy = accuracy)\n  sem <- scales::number(ymax - y, accuracy = accuracy)\n  paste(\"Mean Weight:\", mean, \"+/-\", sem)\n}\n\nv6 <- ggplot(data=loss, \n                   aes(x = Ship_Type),\n) +\n  stat_summary(aes(y = Cargo_Weight_tons, \n                   tooltip = after_stat(  \n                     tooltip(y, ymax))),  \n    fun.data = \"mean_se\", \n    geom = GeomInteractiveCol,  \n    fill = \"steelblue\"\n  ) +\n  stat_summary(aes(y = Cargo_Weight_tons),\n    fun.data = mean_se,\n    geom = \"errorbar\", width = 0.2, size = 0.2\n  ) + \n  labs(\n    title = \"Mean Weights of Ship Types that Incurred Loss\",\n    x = \"Ship Type\",\n    y = \"Weight (tons)\"\n  )\n\ngirafe(ggobj = v6,\n       width_svg = 8,\n       height_svg = 8*0.618)\n```\n:::\n\n:::\n\n### 4.3.4 Median Speed of Each Ship Types\n\nLet us plot a boxplot to find out whether the speed of the ship affects the high operational cost in shipping industry.\n\n::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-8612d07de6aa22cafb27\" style=\"width:100%;height:433px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8612d07de6aa22cafb27\">{\"x\":{\"data\":[{\"x\":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],\"y\":[20.749746644202009,14.750204336958159,17.671558339628614,18.627978593735932,15.378922383758178,22.869095612571016,11.72604812418512,11.285913444426535,13.783019760126097,18.815724603235147,20.918754470750269,11.784053721572969,20.177090496817087,22.840714365082672,15.936367625139248,17.129655988866141,21.133179787269903,14.51956330056106,11.146405599933516,17.211806092832042,13.238650601390486,18.924755487658562,14.387161171562591,23.130730303940982,21.26480771407223,18.855211946018912,18.69640948031676,17.112935486030842,18.254804671475299,21.166977061493274,20.876427539676055,15.563642200982205,12.675495683742838,19.254110823568645,10.21983831371324,14.308677999640466,19.720540195058661,19.36405779496085,10.906243262293536,18.232369324619256,11.098216644574917,11.733155341948883,21.093167976052442,23.344097638763749,15.891656076432954,12.720629481120181,17.215061793474526,24.663078578946429,22.713068803167399,24.781022690560238,16.977537932722161,10.425727089034254,12.704878524092171,12.973719813578811,20.003637143758951,19.911543531092654,17.963292912767319,19.189884562986482,22.52200585482392,21.891006642431194,12.334327249336813,17.545556307930475,19.794901000935688,19.052760335030925,10.368736220100224,20.742090148701536,24.577763902912466,19.418630933936111,19.192298769192419,17.730758682230611,16.752321723261275,21.848303076188849,12.358403791515324,12.181113512911599,11.369269689797989,23.724718550285417,16.988664751456756,18.203337131289317,22.690285838389435,11.716635009427034,16.065575259796944,18.641817628537986,20.427986175499505,14.498463034958055,13.695226625399664,16.987856510340364,16.95038099855352,24.200736810301375,23.67118852870373,11.57540793564138,17.251327826478164,15.424018887132007,16.395409359889005,10.799794142014834,18.475804538668292,11.733102930362088,15.704672100810845,12.70940439649948,23.695808923422199,19.396788831568447,17.36361729127422,22.101473240247294,14.157367648624088,20.183173572703023,13.297285685700135,10.261802360142051,24.352819751494611,20.910589407932868,20.529845214804645,20.828590720455313,22.402751367727681,10.152009109185864,11.165097648065574,11.490034195370717,20.608351567298563,18.174558727841692,18.029754779073585,22.18839883717019,14.857984367824828,11.2091798086101,11.278108915564042,14.804367486824887,17.070687927632932,20.913400097544688,19.918191400403245,11.198828506755619,23.442432344838956,12.902317790313884,18.716382687017269,21.644335847077684,23.47161290917871,20.148455298066736,20.225848561330562,21.678428874293751,11.537601403975961,20.145920507594234,17.856704509268745,17.316362526964941,17.368792221657738,16.368938715875952,12.507941035348214,19.211538423783168,24.154389817592943,11.301333598671958,16.02688617839631,11.347261990238581,21.055102014905927,18.315369257072081,10.479994774409723,23.51418335442153,23.432382091471432,23.927477795978135,20.260429220715753,16.399088131991896,10.716416794002701,15.344910840826117,21.196320357126716,10.479891966905504,14.718474509234111,13.275448182536085,20.40873371174958,20.169328862756579,13.19545736053327,10.051668649487908,12.872824929413463,17.831696449561246,19.641652229383087,20.540279480530241,24.991661381380048,16.466417293735134,24.652068575873365,12.878418676380752,16.107415059764584,19.296709849858761,21.601784301737567,13.193747903748676,10.353266904583135,13.071405073649291,11.995472898834464,15.753487236370029,13.59354588811156,11.467011907276294,15.60136733075435,19.668238197499459,22.060967420614503,10.136147586004091,20.449310077673474,21.132868829214409,11.756274569929833,13.96926482021501,12.464128234806308,14.480471847152316,21.4412715796459,20.408755819894033,17.957242874024885,20.28342119555299,24.709887030760783,11.393050602609121,19.963289870557293,11.01482346094172,13.209630386715686,19.766381479642799,19.181650313842933,17.763479747503403,17.044790275073044,11.69889826429452,13.329077915642332,16.555370887754826,21.548242012267625,20.262325118619486,12.077621919484413,17.020468541616552,24.332275736086196,16.933179797814464,19.288799315176359,24.888326904388951,19.406991569914172,21.00732611136695,17.373569856451414,12.912912744910614,22.634369840776593,17.762273134971391,21.673984822570752,21.889510634227371,14.763044173748879,21.955471237917727,19.174576349347529,20.181101915695105,18.347911002880195,10.849560159276519,10.624913918261326,24.52962223670843,21.163295180725285,11.431366821350595,10.182573544260546,20.122614323307278,10.569350549167533,23.070928566912102,15.572935522502446,24.660120497556321,15.342553375350723,17.915881931538539,10.272017077424699,13.416652151612061,18.060874322669282,14.829758871777384,19.83611094887069,12.943134750348101,18.946905395889743,24.73938224515101,15.253556668582435,24.605940087035737,23.772482019047672,21.988640486769565,12.133410325335904,20.861498431855377,17.044737770537616,17.640318678382705,21.981507143955035,23.683514512568788,18.985646990037178,10.924955564915306,17.453135863068621,14.231627262706606,16.25525009290072,19.162958034337652,14.936720849552984,23.041919943095579,18.842513333026101,17.867501648110402,13.955502957478622,12.203484981652842,24.744224385283069,24.777732227140842,16.03590491754516,16.922824642628189,18.705615917521531,19.628031484236995,10.868454960945236,18.953069444476,23.042576428065782,14.834628911802632,18.338518614881902,23.403212250342087,15.5566441192839,23.484671562704577,23.044816106418757,21.04320848209877,21.318112868527567,17.926527109419723,24.135748517147587,10.757450293608048,11.843814296391056,24.240437251687908,12.576364291267442,10.938772195136131,17.759907642242698,20.013603900839016,24.670115829566878,12.446103398944944,21.077535050963569,23.342623269419164,17.510463664901295,19.974121980025135,24.72018632555157,23.800506217708371,10.189168636968123,14.034218447122342,21.300251695119719,19.705399874511432,16.702985029681027,16.317588752787465,21.56581979725668,21.195769401778954,12.083359804562116,24.625777910708798,13.889766323786368,15.546524785806028,19.378325520048449,10.234470159094434,24.164854988000968,21.455260084084959,13.184581636814571,18.690114800778897,10.803355067107864,17.665006938558633,10.424856329673348,17.133240350455278,11.210318979423848,24.179708632200544,24.718977392828283,17.821376659977542,17.94453142808231,15.966061035573698,23.559303166068624,15.141721711903511,21.058117839507982,21.070377010224107,23.236705072636184,16.891653517980025,23.712539150278083,22.853103695205636,18.478822434170684,16.733885223706647,16.724594845855069,24.233804791164705,13.809424180162098,14.518839584544246,14.739658048183426,22.790188912285856,17.332979880059327,13.632401854323019,16.815151915343989,14.376624927399783,23.637842566025476,11.364106741504161,22.298125756153532,24.951503782262577,16.199060093609646,24.779262881874036,22.59529330840024,13.741346934153595,13.719446359671196,12.507223734306995,17.567229041907769,18.115750601061045,24.155553528105685,11.568380926613131,21.631055736515663,11.546903021918196,23.833433750873994,24.499831698103648,21.030462600493291,16.423466326977362,15.44435822225512,19.718308966231579,10.97723358837413,21.628685465003365,23.596975035880444,17.873116986766441,12.492870524752815,13.76866378466509,23.894538321454569,21.245640140532256,22.627385055475703,19.78049821651642,12.523309277298424,10.785059764609263,23.349979524968695,15.186333746742417,23.74410400412923,13.955633360100652,13.878238887304343,11.067130690685484,10.781238688065914,18.450213852319017,10.347893932115422,16.798392409834296,13.670856963301,10.684151558986784,11.624021114429249,24.620722565820955,15.863137147525524,20.201116285829539,14.771158898154326,10.695974350246381,13.980658714140279,18.98112654626177,24.46724599558155,16.279754091502486,12.854640677637214,11.001116870010993,23.033089751595242,22.688802496015249,14.881836148873155,22.312095207706875,12.6228557684263,19.869490070509823,13.573107496312115,13.553047639654968,19.376284035317028,24.505259756682619,17.797320317524949],\"hoverinfo\":\"y\",\"type\":\"box\",\"fillcolor\":\"rgba(255,255,255,1)\",\"marker\":{\"opacity\":null,\"outliercolor\":\"rgba(0,0,0,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\"},\"size\":5.6692913385826778},\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":1.8897637795275593},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":44.493150684931507,\"r\":7.3059360730593621,\"b\":40.913242009132432,\"l\":37.260273972602747},\"plot_bgcolor\":\"rgba(235,235,235,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Boxplot of Ship Speed by Ship Type\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Bulk Carrier\",\"Container Ship\",\"Fish Carrier\",\"Tanker\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Bulk Carrier\",\"Container Ship\",\"Fish Carrier\",\"Tanker\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716894984},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Ship Type\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[9.3046690128933012,25.738661017974657],\"tickmode\":\"array\",\"ticktext\":[\"10\",\"15\",\"20\",\"25\"],\"tickvals\":[10,15,20,25],\"categoryorder\":\"array\",\"categoryarray\":[\"10\",\"15\",\"20\",\"25\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Speed\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716894984}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"37546f6b67cb\":{\"x\":{},\"y\":{},\"type\":\"box\"}},\"cur_data\":\"37546f6b67cb\",\"visdat\":{\"37546f6b67cb\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nFrom this boxplot, we can see that container ship has the highest median of ship speed. The high operational cost of container ship could potentially be caused by the machine or engine requirements to operate faster ships. This could also be caused by other required logistics that might be more complicated in container ship as compared to a fish carrier.\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv7 <- ggplot(loss, \n       aes(x = Ship_Type, \n           y = Speed_Over_Ground_knots)) +\n  geom_boxplot(width = .20,\n               outlier.shape = NA,\n               position = position_nudge(x = -0.2)) +\n  labs(\n    title = \"Boxplot of Ship Speed by Ship Type\",\n    x = \"Ship Type\",\n    y = \"Speed\"\n  )\n\nggplotly(v7)\n```\n:::\n\n:::\n\n## 4.4 Maintenance Status of Ships That Incurs Losses\n\nIn this section, we will highlight ships with critical maintenance status. The purpose is to focus on ships with bad maintenance quality and pay attention to ship types that require more maintenance.\n\nBefore we create the plot, let us calculate the percentage of ships with critical maintenance status using the code below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nc8 <- ship %>%\n  group_by(Ship_Type) %>%\n  summarise(\n    Total = n(),\n    Critical_Count = sum(Maintenance_Status == \"Critical\"),\n    Critical_Percentage = (Critical_Count / Total) * 100\n  )\n```\n:::\n\n\nAfter deriving a variable to calculate the percentage, now let us plot and compare the maintenance status of each ship type.\n\n::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-d94a4351f8b2844cea63\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d94a4351f8b2844cea63\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":0.89999999999999991,\"base\":0,\"x\":[1],\"y\":[33.636363636363633],\"text\":\"Ship_Type: Bulk Carrier<br />Critical_Percentage: 33.63636<br />Ship_Type: Bulk Carrier\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(102,194,165,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Bulk Carrier\",\"legendgroup\":\"Bulk Carrier\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.90000000000000013,\"base\":0,\"x\":[2],\"y\":[34.351145038167942],\"text\":\"Ship_Type: Container Ship<br />Critical_Percentage: 34.35115<br />Ship_Type: Container Ship\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(252,141,98,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Container Ship\",\"legendgroup\":\"Container Ship\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.90000000000000036,\"base\":0,\"x\":[3],\"y\":[33.781190019193858],\"text\":\"Ship_Type: Fish Carrier<br />Critical_Percentage: 33.78119<br />Ship_Type: Fish Carrier\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(141,160,203,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Fish Carrier\",\"legendgroup\":\"Fish Carrier\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.90000000000000036,\"base\":0,\"x\":[4],\"y\":[32.894736842105267],\"text\":\"Ship_Type: Tanker<br />Critical_Percentage: 32.89474<br />Ship_Type: Tanker\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(231,138,195,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Tanker\",\"legendgroup\":\"Tanker\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1],\"y\":[33.636363636363633],\"text\":\"33.6%\",\"hovertext\":\"Ship_Type: Bulk Carrier<br />Critical_Percentage: 33.63636<br />Ship_Type: Bulk Carrier<br />paste0(round(Critical_Percentage, 1), \\\"%\\\"): 33.6%\",\"textfont\":{\"size\":14.66456692913386,\"color\":\"rgba(0,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"name\":\"Bulk Carrier\",\"legendgroup\":\"Bulk Carrier\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[2],\"y\":[34.351145038167942],\"text\":\"34.4%\",\"hovertext\":\"Ship_Type: Container Ship<br />Critical_Percentage: 34.35115<br />Ship_Type: Container Ship<br />paste0(round(Critical_Percentage, 1), \\\"%\\\"): 34.4%\",\"textfont\":{\"size\":14.66456692913386,\"color\":\"rgba(0,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"name\":\"Container Ship\",\"legendgroup\":\"Container Ship\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[3],\"y\":[33.781190019193858],\"text\":\"33.8%\",\"hovertext\":\"Ship_Type: Fish Carrier<br />Critical_Percentage: 33.78119<br />Ship_Type: Fish Carrier<br />paste0(round(Critical_Percentage, 1), \\\"%\\\"): 33.8%\",\"textfont\":{\"size\":14.66456692913386,\"color\":\"rgba(0,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"name\":\"Fish Carrier\",\"legendgroup\":\"Fish Carrier\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[4],\"y\":[32.894736842105267],\"text\":\"32.9%\",\"hovertext\":\"Ship_Type: Tanker<br />Critical_Percentage: 32.89474<br />Ship_Type: Tanker<br />paste0(round(Critical_Percentage, 1), \\\"%\\\"): 32.9%\",\"textfont\":{\"size\":14.66456692913386,\"color\":\"rgba(0,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"name\":\"Tanker\",\"legendgroup\":\"Tanker\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":37.260273972602747},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Percentage of Critical Maintenance Status by Ship Type\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Bulk Carrier\",\"Container Ship\",\"Fish Carrier\",\"Tanker\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Bulk Carrier\",\"Container Ship\",\"Fish Carrier\",\"Tanker\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Ship Type\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1.7175572519083973,36.068702290076338],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"10\",\"20\",\"30\"],\"tickvals\":[0,10,20,30],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"10\",\"20\",\"30\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Percentage of Critical Status\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Ship_Type\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"37542dd96159\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"},\"37543f815084\":{\"x\":{},\"y\":{},\"fill\":{},\"label\":{}}},\"cur_data\":\"37542dd96159\",\"visdat\":{\"37542dd96159\":[\"function (y) \",\"x\"],\"37543f815084\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nFrom the bar chart, container ship has the highest percentage of ships that is not well-maintained. A well-maintained ship can help reduce the repair cost and the frequency of repairs, minimize downtime to help ship operate efficiently and it will also help them attract more businesses to use the service. This data shows that we should pay more attention to maintenance to help a smoother operations in the maritime industry.\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv8 <- ggplot(c8, aes(x = Ship_Type,\n                             y = Critical_Percentage,\n                             fill = Ship_Type)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = paste0(round(Critical_Percentage, 1), \"%\")),\n            vjust = -0.5) +\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(title = \"Percentage of Critical Maintenance Status by Ship Type\",\n       x = \"Ship Type\",\n       y = \"Percentage of Critical Status\") +\n  theme_minimal()\n\nggplotly(v8)\n```\n:::\n\n:::\n\n# 5 Conclusion\n\nThe analysis on shipping industry suggests that there are a lot of room for improvements in the maritime industry, such as keeping a good level of ship maintenance to reduce unnecessary costs that prevent them to gain profits from operating ships. Other than the level of maintenance, it is also beneficial to choose the most optimal route of the ships to optimize the engine usage. Shipping industry also needs to pay attention to the engine types used for the ships and to use the necessary engines that fit the needs and requirements to prevent additional cost that does not benefit the voyage. In conclusion, there are a lot of loss incurred and it might affect the businesses in the long run. Therefore, additional analysis on the problems and bottlenecks will help improve the business significantly and avoid unnecessary cost.\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n<script src=\"../../site_libs/d3-bundle-5.16.0/d3-bundle.min.js\"></script>\n<script src=\"../../site_libs/d3-lasso-0.0.5/d3-lasso.min.js\"></script>\n<script src=\"../../site_libs/save-svg-as-png-1.4.17/save-svg-as-png.min.js\"></script>\n<script src=\"../../site_libs/flatbush-4.4.0/flatbush.min.js\"></script>\n<link href=\"../../site_libs/ggiraphjs-0.8.10/ggiraphjs.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/ggiraphjs-0.8.10/ggiraphjs.min.js\"></script>\n<script src=\"../../site_libs/girafe-binding-0.8.12/girafe.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}